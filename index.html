<iframe src="data:text/html;base64,PGh0bWw+CiAgICA8aGVhZD4KICAgICAgICA8dGl0bGU+T2ZmbGluZSBQYXJhZGlzZTwvdGl0bGU+CiAgICAgICAgPHNjcmlwdCBzcmM9Jy9ldmVyeXBhZ2UuanMnPjwvc2NyaXB0PgogICAgPC9oZWFkPgogICAgPGJvZHkgc3R5bGU9Ii13ZWJraXQtdXNlci1zZWxlY3Q6IG5vbmU7IHVzZXItc2VsZWN0OiBub25lOyBvdmVyc2Nyb2xsOiBub25lOyBvdmVyZmxvdzogaGlkZGVuOyBib3JkZXI6IG5vbmU7IG1hcmdpbjogbm9uZTsgcGFkZGluZzogbm9uZTsiPgogICAgICAgIDxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPgogICAgICAgIDxzdHlsZT4KICAgICAgICAgICAgYm9keSB7CiAgICAgICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMjIyOwogICAgICAgICAgICAgICAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTsKICAgICAgICAgICAgICAgIHVzZXItc2VsZWN0OiBub25lOwogICAgICAgICAgICAgICAgb3ZlcnNjcm9sbDogbm9uZTsKICAgICAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICAgICAgICAgICAgICBib3JkZXI6IG5vbmU7CiAgICAgICAgICAgICAgICBtYXJnaW46IG5vbmU7CiAgICAgICAgICAgICAgICBwYWRkaW5nOiBub25lOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC5vdmVybGF5LAogICAgICAgICAgICBib2R5IHsKICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgICAgICB3aWR0aDogMTAwdnc7CiAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwMHZoOwogICAgICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgICAgICAgICAgY29sb3I6ICNlZWU7CiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMjIyOwogICAgICAgICAgICAgICAgZm9udC1mYW1pbHk6IHNhbnMtc2VyaWY7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLm92ZXJsYXkgewogICAgICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgICAgICAgICAgZGlzcGxheTogbm9uZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBib2R5LmxvYWRpbmcgLm92ZXJsYXkgewogICAgICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAgfQogICAgICAgICAgICBjYW52YXMgewogICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgICAgICAgICBvYmplY3QtZml0OiBjb250YWluOwogICAgICAgICAgICB9CiAgICAgICAgPC9zdHlsZT4KICAgICAgICA8Y2FudmFzIHdpZHRoPSIxOTIwIiBoZWlnaHQ9IjEwODAiIHN0eWxlPSItd2Via2l0LXVzZXItc2VsZWN0OiBub25lOyB1c2VyLXNlbGVjdDogbm9uZTsgb3ZlcnNjcm9sbDogbm9uZTsgb3ZlcmZsb3c6IGhpZGRlbjsgYm9yZGVyOiBub25lOyBtYXJnaW46IG5vbmU7IHBhZGRpbmc6IG5vbmU7Ij48L2NhbnZhcz4KICAgICAgICA8ZGl2IGNsYXNzPSJvdmVybGF5Ij5HZW5lcmF0aW5nIGFzc2V0cy4uLjwvZGl2PgogICAgICAgIDxzY3JpcHQ+CiAgICAgICAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgICAgICAgbGV0IGcgPSAxIC8gNjAsCiAgICAgICAgICAgICAgICBoLAogICAgICAgICAgICAgICAgaywKICAgICAgICAgICAgICAgIGwsCiAgICAgICAgICAgICAgICBtOwogICAgICAgICAgICB2YXIgbiA9IG51bGwsCiAgICAgICAgICAgICAgICBhYSA9IG51bGwsCiAgICAgICAgICAgICAgICBiYSA9IG51bGwsCiAgICAgICAgICAgICAgICBxID0gbnVsbDsKICAgICAgICAgICAgbGV0IGNhID0gMDsKICAgICAgICAgICAgZnVuY3Rpb24gZGEoYSkgewogICAgICAgICAgICAgICAgYSA9ICgyNDAgKyA3MCAqIGEpICUgMzYwOwogICAgICAgICAgICAgICAgbiA9IGBoc2woJHthfSwgJHswfSUsICR7OTN9JSlgOwogICAgICAgICAgICAgICAgYSArPSAyMDsKICAgICAgICAgICAgICAgIGFhID0gYGhzbCgke2F9LCAkezF9JSwgJHs3MH0lKWA7CiAgICAgICAgICAgICAgICBhICs9IDIwOwogICAgICAgICAgICAgICAgYmEgPSBgaHNsKCR7YX0sICR7NX0lLCAkezQ5fSUpYDsKICAgICAgICAgICAgICAgIHEgPSBgaHNsKCR7YSArIDIwfSwgJHsyMX0lLCAkezE3fSUpYDsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgdCA9IHt9LAogICAgICAgICAgICAgICAgdSA9IHt9OwogICAgICAgICAgICBmdW5jdGlvbiBmYSgpIHsKICAgICAgICAgICAgICAgIFsxLCA0LCAyLCA4LCAxNiwgMzJdLmZvckVhY2goKGEpID0+IHsKICAgICAgICAgICAgICAgICAgICB1W2FdID0gdFthXTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxldCBoYSA9IHsgMzc6IDEsIDM5OiA0LCAzODogMiwgNDA6IDgsIDE2OiAxNiwgOTA6IDMyLCAzMjogMzIgfTsKICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigKICAgICAgICAgICAgICAgICJrZXlkb3duIiwKICAgICAgICAgICAgICAgICh7IGtleUNvZGU6IGEgfSkgPT4gewogICAgICAgICAgICAgICAgICAgIGlmICgoYSA9IGhhW2FdKSkgKHVbYV0gPSB0W2FdKSwgKHRbYV0gPSAhMCk7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgITEKICAgICAgICAgICAgKTsKICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigKICAgICAgICAgICAgICAgICJrZXl1cCIsCiAgICAgICAgICAgICAgICAoeyBrZXlDb2RlOiBhIH0pID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAoKGEgPSBoYVthXSkpICh1W2FdID0gdFthXSksICh0W2FdID0gITEpOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICExCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHZhciBpYSA9IHsKICAgICAgICAgICAgICAgICAgICBtYToKICAgICAgICAgICAgICAgICAgICAgICAgImRhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaExBQWNBS0lBQU9BMS8yd3g4anV6L3publd2K3pPLy8vLzlQVDAvLy8veUg1QkFFQUFBY0FMQUFBQUFBc0FCd0FBQVAvZUxyUSszRElRUWg4cGR6YjNKNVROV3hIbHBGTUIxd2dKWTZYZVc1ZG9FYmdLMjJ5Wmo0cVd5T3dhRkZBaTU1U2xxb0JiTVZjUzdHc0VKVE9iSURZSWt5cFBXdWxGeFErdDF6ajdtRUlpNjhuMWZCNVRrOVFCNFBlSkNiTDZXaEVlQ1F5WXowSFF6YUthQ3gzS0V1SGlIT0JqVjh4a0FWNkVKUWZhanhNZXBxRG5aNFFiUmtHbzZOU1NLYWllQUt4ZzZ4cnFoQ3hzbmhkWGpCZ1B5aTR1Ym81SXI2L0pNRUJ1S3NoRm9pUkc4cXgwc0syQ2gyWUJTc0hBc3JVMVNoZkRkbmFXOVBKeTVYaWZtU0J1T2JwRDdRWWZuSm8zZmpCQWpnU3ZMVWxXT3pkK3hidlFMTldWTEJsQUtEdGhqdHYwbkRvNkhYdFQ4TU9DeDRXTk9nQ0R5RVFCMysyUGVEMGdaYzFPUXNTQUFBNyIsCiAgICAgICAgICAgICAgICAgICAgWTogWwogICAgICAgICAgICAgICAgICAgICAgICB7IHg6IDAsIHk6IDAsIGk6IDEzLCBoOiAxMywgajogMTEsIGw6IDExIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsgeDogMTQsIHk6IDAsIGk6IDEzLCBoOiA5LCBqOiA3LCBsOiAxIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsgeDogMjgsIHk6IDAsIGk6IDE2LCBoOiAxNSwgajogOSwgbDogOCB9LAogICAgICAgICAgICAgICAgICAgICAgICB7IHg6IDE3LCB5OiAxMCwgaTogMTEsIGg6IDksIGo6IDEwLCBsOiA4IH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsgeDogMCwgeTogMTUsIGk6IDE2LCBoOiAxMywgajogNiwgbDogMTIgfSwKICAgICAgICAgICAgICAgICAgICAgICAgeyB4OiAxNiwgeTogMjAsIGk6IDEyLCBoOiA4LCBqOiAyLCBsOiA3IH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsgeDogMjksIHk6IDE2LCBpOiAxNSwgaDogMTIsIGo6IDgsIGw6IDYgfSwKICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGphID0gewogICAgICAgICAgICAgICAgICAgIG1hOgogICAgICAgICAgICAgICAgICAgICAgICAiZGF0YTppbWFnZS9naWY7YmFzZTY0LFIwbEdPRGxoc3dBRkFJQUFBQUFBQVAvLy95SDVCQUVBQUFFQUxBQUFBQUN6QUFVQUFBS1JEQjUya0lyTDNJT0pSbE5SZm8zZDJtR2dzMTFMMloyUUY1b2k1c1pVMXRSMnFjR3RIZk4rN1JyNUlrU2U1d2pxSlhmTFcxQzNaRUdmTDhYdCtsb2ROWjhzYWRPYW5JVEFiMVhIU29lNWExUE8yMFRENCtjdUZqaUc2b1hTVURuK3BGVDBOOVhYbDhSQk5oY2twYmIzWWVjRUdTa3pabUZwSVprb2ttZlpaZ2puYWJTNUJZbG55aFNZSW9yM1l4VlFBQUE3IiwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBrYSA9IHsKICAgICAgICAgICAgICAgICAgICBtYTogImRhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaEd3QURBSUFBQUJnUUsvLy8veUg1QkFFQUFBRUFMQUFBQUFBYkFBTUFBQUlRakErUmFMa0syNWxzdlV1ZmpDNmlBZ0E3IiwKICAgICAgICAgICAgICAgICAgICBZOiBbCiAgICAgICAgICAgICAgICAgICAgICAgIHsgeDogMCwgeTogMCwgaTogMywgaDogMywgajogMSwgbDogMSB9LAogICAgICAgICAgICAgICAgICAgICAgICB7IHg6IDQsIHk6IDAsIGk6IDMsIGg6IDMsIGo6IDEsIGw6IDEgfSwKICAgICAgICAgICAgICAgICAgICAgICAgeyB4OiA4LCB5OiAwLCBpOiAzLCBoOiAzLCBqOiAxLCBsOiAxIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsgeDogMTIsIHk6IDAsIGk6IDMsIGg6IDMsIGo6IDEsIGw6IDEgfSwKICAgICAgICAgICAgICAgICAgICAgICAgeyB4OiAxNiwgeTogMCwgaTogMywgaDogMywgajogMSwgbDogMSB9LAogICAgICAgICAgICAgICAgICAgICAgICB7IHg6IDIwLCB5OiAwLCBpOiAzLCBoOiAzLCBqOiAxLCBsOiAxIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsgeDogMjQsIHk6IDAsIGk6IDMsIGg6IDMsIGo6IDEsIGw6IDEgfSwKICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGxhID0gewogICAgICAgICAgICAgICAgICAgIG1hOgogICAgICAgICAgICAgICAgICAgICAgICAiZGF0YTppbWFnZS9naWY7YmFzZTY0LFIwbEdPRGxoUmdBTkFKRUFBUC95cXRTR0lmLy8vd0FBQUNINUJBRUFBQUlBTEFBQUFBQkdBQTBBQUFLbmxCVjV5NTNSb21SdnhnQXlkSXBtc0ZIZFVwRmZTSTVHQXFMcktiWXBwcG4xd2FydmpkQWdKOFA1WEwzZ0NqTmk4WVRHUjRuSmN6NTd3Mk9WS2szQkVKOHR0dVR6SXJPMExMZjdzenAzM1UzNDl2NHAwZlAyR1MzSHUvWHNiWHl2RjVlSE4yaDM1OGZYNS9JR1VTZjMxNWg0aUJKR2FVaEZwMml6VkxtWmRoaDFDWnJHaUNOYStwTERwaFF5OWptRVpNb3FHMXVVbVZwYmR0YmE4bHBUeTZWS1MzcWlXd0FBT3c9PSIsCiAgICAgICAgICAgICAgICAgICAgWTogWwogICAgICAgICAgICAgICAgICAgICAgICB7IHg6IDEsIHk6IDAsIGk6IDgsIGg6IDEzLCBqOiA0LCBsOiAxMyB9LAogICAgICAgICAgICAgICAgICAgICAgICB7IHg6IDEwLCB5OiAwLCBpOiA5LCBoOiAxMywgajogNSwgbDogMTMgfSwKICAgICAgICAgICAgICAgICAgICAgICAgeyB4OiAyMSwgeTogMCwgaTogOCwgaDogMTMsIGo6IDQsIGw6IDEzIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsgeDogMzAsIHk6IDAsIGk6IDEwLCBoOiAxMywgajogNSwgbDogMTMgfSwKICAgICAgICAgICAgICAgICAgICAgICAgeyB4OiA0MCwgeTogMCwgaTogMTAsIGg6IDEzLCBqOiA1LCBsOiAxMyB9LAogICAgICAgICAgICAgICAgICAgICAgICB7IHg6IDUwLCB5OiAwLCBpOiAxMCwgaDogMTMsIGo6IDUsIGw6IDEzIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsgeDogNjAsIHk6IDAsIGk6IDEwLCBoOiAxMywgajogNSwgbDogMTMgfSwKICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIG1hID0geyBtYTogImRhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaENRQUlBSkVBQUplWGwvLy8vd0FBQUFBQUFDSDVCQUVBQUFJQUxBQUFBQUFKQUFnQUFBSVVoRzhDd1IzRzBGTnRUUnF2c2xwczVvV2VVUUFBT3c9PSIsIFk6IFt7IHg6IDAsIHk6IDAsIGk6IDksIGg6IDgsIGo6IDEwLCBsOiA4IH1dIH07CiAgICAgICAgICAgIGxldCB2ID0gbmV3IEF1ZGlvQ29udGV4dCgpLAogICAgICAgICAgICAgICAgdyA9IHYuY3JlYXRlRHluYW1pY3NDb21wcmVzc29yKCk7CiAgICAgICAgICAgIHcua25lZS5zZXRWYWx1ZUF0VGltZSg0MCwgMCk7CiAgICAgICAgICAgIHcudGhyZXNob2xkLnNldFZhbHVlQXRUaW1lKC0xMiwgMCk7CiAgICAgICAgICAgIHcuY29ubmVjdCh2LmRlc3RpbmF0aW9uKTsKICAgICAgICAgICAgbGV0IHg7CiAgICAgICAgICAgIGZ1bmN0aW9uIHkoYSkgewogICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguc2luKDIgKiBNYXRoLlBJICogYSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24geigpIHsKICAgICAgICAgICAgICAgIHJldHVybiAyICogTWF0aC5yYW5kb20oKSAtIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gQShhLCBiKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBjID0gMDsgYyA8IGIubGVuZ3RoIC0gMTsgYysrKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IFtkLCBlLCBmID0gMV0gPSBiW2NdLAogICAgICAgICAgICAgICAgICAgICAgICBbcCwgcl0gPSBiW2MgKyAxXTsKICAgICAgICAgICAgICAgICAgICBpZiAoZCA8PSBhICYmIGEgPCBwKSByZXR1cm4gKGEgPSAoYSAtIGQpIC8gKHAgLSBkKSksIChhID0gMSA8IGYgPyBNYXRoLnBvdyhhLCBmKSA6IDEgLSBNYXRoLnBvdygxIC0gYSwgMSAvIGYpKSwgZSArIGEgKiAociAtIGUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGJbYi5sZW5ndGggLSAxXVsxXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBCKGEpIHsKICAgICAgICAgICAgICAgIHJldHVybiAibnVtYmVyIiA9PT0gdHlwZW9mIGEKICAgICAgICAgICAgICAgICAgICA/IFsKICAgICAgICAgICAgICAgICAgICAgICAgICBbMCwgYV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgWzEsIGFdLAogICAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgICAgIDogYTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBuYShhLCBiKSB7CiAgICAgICAgICAgICAgICBhID0gTWF0aC50YW4oKE1hdGguUEkgKiBhKSAvIHYuc2FtcGxlUmF0ZSk7CiAgICAgICAgICAgICAgICBsZXQgYyA9IGEgKiBhOwogICAgICAgICAgICAgICAgYiA9IDEgLyBiOwogICAgICAgICAgICAgICAgbGV0IGQgPSAxIC8gKDEgKyBiICogYSArIGMpOwogICAgICAgICAgICAgICAgcmV0dXJuIFtkIC8gMSwgLTIgKiBkLCBkIC8gMSwgMiAqIGQgKiAoYyAtIDEpLCBkICogKDEgLSBiICogYSArIGMpXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBvYShhLCBiKSB7CiAgICAgICAgICAgICAgICBhID0gMSAvIE1hdGgudGFuKChNYXRoLlBJICogYSkgLyB2LnNhbXBsZVJhdGUpOwogICAgICAgICAgICAgICAgbGV0IGMgPSBhICogYTsKICAgICAgICAgICAgICAgIGIgPSAxIC8gYjsKICAgICAgICAgICAgICAgIGxldCBkID0gMSAvICgxICsgYiAqIGEgKyBjKTsKICAgICAgICAgICAgICAgIHJldHVybiBbZCAvIDEsIDIgKiBkLCBkIC8gMSwgMiAqIGQgKiAoMSAtIGMpLCBkICogKDEgLSBiICogYSArIGMpXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBwYShhLCBiKSB7CiAgICAgICAgICAgICAgICBhID0gMSAvIE1hdGgudGFuKChNYXRoLlBJICogYSkgLyB2LnNhbXBsZVJhdGUpOwogICAgICAgICAgICAgICAgbGV0IGMgPSBhICogYTsKICAgICAgICAgICAgICAgIGIgPSAxIC8gYjsKICAgICAgICAgICAgICAgIGxldCBkID0gMSAvICgxICsgYiAqIGEgKyBjKTsKICAgICAgICAgICAgICAgIHJldHVybiBbZCAqIGEgKiBiLCAwLCAtZCAqIGEgKiBiLCAyICogZCAqICgxIC0gYyksIGQgKiAoMSAtIGIgKiBhICsgYyldOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHFhKGEsIGIsIGMsIGQpIHsKICAgICAgICAgICAgICAgIGxldCBlID0gMCwKICAgICAgICAgICAgICAgICAgICBmID0gMDsKICAgICAgICAgICAgICAgIGZvciAobGV0IHAgPSAwOyBwIDwgYS5sZW5ndGg7ICsrcCkgewogICAgICAgICAgICAgICAgICAgIGxldCByID0gYihBKHAgLyAoYS5sZW5ndGggLSAxKSwgYyksIEEocCAvIChhLmxlbmd0aCAtIDEpLCBkKSksCiAgICAgICAgICAgICAgICAgICAgICAgIE8gPSBhW3BdLAogICAgICAgICAgICAgICAgICAgICAgICBlYSA9IE8gKiByWzBdICsgZTsKICAgICAgICAgICAgICAgICAgICBhW3BdID0gZWE7CiAgICAgICAgICAgICAgICAgICAgZSA9IE8gKiByWzFdIC0gZWEgKiByWzNdICsgZjsKICAgICAgICAgICAgICAgICAgICBmID0gTyAqIHJbMl0gLSBlYSAqIHJbNF07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gYTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiByYShhLCBiKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcWEoYSwgb2EsIEIoYiksIEIoTWF0aC5TUVJUMV8yKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gc2EoYSwgYikgewogICAgICAgICAgICAgICAgcmV0dXJuIHFhKGEsIG5hLCBCKGIpLCBCKE1hdGguU1FSVDFfMikpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHRhKGEsIGIsIGMgPSBNYXRoLlNRUlQxXzIpIHsKICAgICAgICAgICAgICAgIHJldHVybiBxYShhLCBwYSwgQihiKSwgQihjKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gdWEoYSkgewogICAgICAgICAgICAgICAgZm9yIChsZXQgYiA9IDA7IGIgPCBhLmxlbmd0aDsgYisrKSAoYVtiXSAqPSAzKSwgKGFbYl0gPSAtMSA+IGFbYl0gPyAtMSA6IDEgPCBhW2JdID8gMSA6IE1hdGguc2luKChhW2JdICogTWF0aC5QSSkgLyAyKSksIChhW2JdIC89IDMpOwogICAgICAgICAgICAgICAgcmV0dXJuIGE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gdmEoYSwgYikgewogICAgICAgICAgICAgICAgbGV0IGMgPSAwOwogICAgICAgICAgICAgICAgYS5mb3JFYWNoKChhKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgYyA9IE1hdGgubWF4KGMsIGEubGVuZ3RoKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbGV0IGQgPSBuZXcgRmxvYXQzMkFycmF5KGMpOwogICAgICAgICAgICAgICAgYS5mb3JFYWNoKChjLCBmKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgZSA9IDA7IGUgPCBjLmxlbmd0aDsgZSsrKSBiKGQsIGYsIGMsIGUsIGEubGVuZ3RoKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuIGQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gd2EoYSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHZhKGEsIChhLCBjLCBkLCBlLCBmKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgYVtlXSArPSBkW2VdIC8gZjsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHhhKGEpIHsKICAgICAgICAgICAgICAgIHJldHVybiB2YShhLCAoYSwgYywgZCwgZSwgZikgPT4gewogICAgICAgICAgICAgICAgICAgIDAgPT09IGMgJiYgKGFbZV0gPSAxKTsKICAgICAgICAgICAgICAgICAgICBhW2VdICo9IGRbZV0gLyBmOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gQyhhLCBiKSB7CiAgICAgICAgICAgICAgICBhID0gbmV3IEZsb2F0MzJBcnJheShhICogdi5zYW1wbGVSYXRlKTsKICAgICAgICAgICAgICAgIGZvciAobGV0IGMgPSAwOyBjIDwgYS5sZW5ndGg7IGMrKykgYVtjXSA9IGIoYyAvIGEubGVuZ3RoLCBjIC8gdi5zYW1wbGVSYXRlKTsKICAgICAgICAgICAgICAgIHJldHVybiBhOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIEQoYSwgYikgewogICAgICAgICAgICAgICAgZm9yIChsZXQgYyA9IDA7IGMgPCBhLmxlbmd0aDsgYysrKSBhW2NdICo9IEEoYyAvIGEubGVuZ3RoLCBiKTsKICAgICAgICAgICAgICAgIHJldHVybiBhOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHlhKCkgewogICAgICAgICAgICAgICAgbGV0IGEgPSBbCiAgICAgICAgICAgICAgICAgICAgICAgIFswLCAwLjAxLCAyXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzEsIDBdLAogICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgYiA9IHooKTsKICAgICAgICAgICAgICAgIHJldHVybiBEKAogICAgICAgICAgICAgICAgICAgIHdhKFsKICAgICAgICAgICAgICAgICAgICAgICAgc2EoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDKDAuMywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgucmFuZG9tKCkgPCA1ZTMgLyB2LnNhbXBsZVJhdGUgJiYgKGIgPSB6KCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA5MDAKICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGEoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDKDAuMywgZnVuY3Rpb24gKGMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpIDwgQShjLCBhKSAmJiAoYiA9IHooKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEwMAogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIF0pLAogICAgICAgICAgICAgICAgICAgIFsKICAgICAgICAgICAgICAgICAgICAgICAgWzAsIDBdLAogICAgICAgICAgICAgICAgICAgICAgICBbMC4xLCAxLCAwLjhdLAogICAgICAgICAgICAgICAgICAgICAgICBbMC4yLCAwLjMsIDAuOV0sCiAgICAgICAgICAgICAgICAgICAgICAgIFsxLCAwXSwKICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHphKCkgewogICAgICAgICAgICAgICAgbGV0IGEgPSAwLAogICAgICAgICAgICAgICAgICAgIGIgPSBbCiAgICAgICAgICAgICAgICAgICAgICAgIFswLCA0MCwgMC4yXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzEsIDIwXSwKICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgICAgIGMgPSB6KCk7CiAgICAgICAgICAgICAgICByZXR1cm4geGEoWwogICAgICAgICAgICAgICAgICAgIEMoMC4yLCBmdW5jdGlvbiAoYykgewogICAgICAgICAgICAgICAgICAgICAgICBhICs9IEEoYywgYikgLyB2LnNhbXBsZVJhdGU7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiA0MCAqICgyICogTWF0aC5hYnMoKGEgJSAxKSAqIDIgLSAxKSAtIDEpOwogICAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgICAgIEQoCiAgICAgICAgICAgICAgICAgICAgICAgIHVhKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQygwLjIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLnJhbmRvbSgpIDwgNTAwIC8gdi5zYW1wbGVSYXRlICYmIChjID0geigpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgIFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFswLCAxLCAwLjVdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzEsIDBdLAogICAgICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIF0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIEFhKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRhKAogICAgICAgICAgICAgICAgICAgIEQoQygwLjIsIHopLCBbCiAgICAgICAgICAgICAgICAgICAgICAgIFswLCAwLCAwLjVdLAogICAgICAgICAgICAgICAgICAgICAgICBbMC4xLCAwLjUsIDAuMl0sCiAgICAgICAgICAgICAgICAgICAgICAgIFsxLCAwXSwKICAgICAgICAgICAgICAgICAgICBdKSwKICAgICAgICAgICAgICAgICAgICAyZTMKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gQmEoKSB7CiAgICAgICAgICAgICAgICBsZXQgYSA9IHooKSwKICAgICAgICAgICAgICAgICAgICBiID0gMCwKICAgICAgICAgICAgICAgICAgICBjID0gWwogICAgICAgICAgICAgICAgICAgICAgICBbMCwgMmUzLCAwLjJdLAogICAgICAgICAgICAgICAgICAgICAgICBbMSwgMjAwXSwKICAgICAgICAgICAgICAgICAgICBdOwogICAgICAgICAgICAgICAgcmV0dXJuIEQoCiAgICAgICAgICAgICAgICAgICAgQygwLjMsIGZ1bmN0aW9uIChkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIDEgPD0gYiAmJiAoKGEgPSB6KCkpLCAtLWIpOwogICAgICAgICAgICAgICAgICAgICAgICBiICs9IEEoZCwgYykgLyB2LnNhbXBsZVJhdGU7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhOwogICAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgICAgIFsKICAgICAgICAgICAgICAgICAgICAgICAgWzAsIDAuNSwgMC41XSwKICAgICAgICAgICAgICAgICAgICAgICAgWzEsIDBdLAogICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gQ2EoKSB7CiAgICAgICAgICAgICAgICBsZXQgYSA9IDAsCiAgICAgICAgICAgICAgICAgICAgYiA9IFsKICAgICAgICAgICAgICAgICAgICAgICAgWzAsIDQ0MCwgMC4yXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzEsIDIyMDBdLAogICAgICAgICAgICAgICAgICAgIF07CiAgICAgICAgICAgICAgICByZXR1cm4gRCgKICAgICAgICAgICAgICAgICAgICBDKDAuNSwgZnVuY3Rpb24gKGMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYSArPSBBKGMsIGIpIC8gdi5zYW1wbGVSYXRlOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKDIgKiBNYXRoLmFicygoYSAlIDEpICogMiAtIDEpIC0gMSArICgoYSAlIDEpICogMiAtIDEpKSAvIDI7CiAgICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgICAgICAgICBbMCwgMCwgMC41XSwKICAgICAgICAgICAgICAgICAgICAgICAgWzAuMSwgMSwgMC41XSwKICAgICAgICAgICAgICAgICAgICAgICAgWzEsIDBdLAogICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gRGEoKSB7CiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhKGEpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgYiA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBbXTsKICAgICAgICAgICAgICAgICAgICBkbyBjLnB1c2goW2IsIGEgPyAxIDogMC40NV0pLCAoYSA9ICFhKSwgKGIgKz0gMC4xODc1KSwgYy5wdXNoKFtiIC0gMWUtNywgMF0pOwogICAgICAgICAgICAgICAgICAgIHdoaWxlICgxID49IGIpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBjOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IGIgPSBhKCEwKSwKICAgICAgICAgICAgICAgICAgICBjID0gYSghMSksCiAgICAgICAgICAgICAgICAgICAgZCA9IFsKICAgICAgICAgICAgICAgICAgICAgICAgWzAsIDAsIDAuNV0sCiAgICAgICAgICAgICAgICAgICAgICAgIFswLjA1LCAxLCAwLjVdLAogICAgICAgICAgICAgICAgICAgICAgICBbMSwgMF0sCiAgICAgICAgICAgICAgICAgICAgXTsKICAgICAgICAgICAgICAgIHJldHVybiBbRChEKEMoNCwgeiksIGIpLCBkKSwgRChEKEMoNCwgeiksIGMpLCBkKV07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IEUgPSAoYSkgPT4gKDAgPCBhID8gMSA6IDAgPiBhID8gLTEgOiAwKSwKICAgICAgICAgICAgICAgIEYgPSAoYSwgYiwgYykgPT4gKGEgPiBiID8gTWF0aC5tYXgoYSAtIGMsIGIpIDogTWF0aC5taW4oYSArIGMsIGIpKTsKICAgICAgICAgICAgZnVuY3Rpb24gRyhhLCBiKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gYS54ICsgYS53aWR0aCA+IGIueCAmJiBhLnggPCBiLnggKyBiLndpZHRoICYmIGEueSArIGEuaGVpZ2h0ID4gYi55ICYmIGEueSA8IGIueSArIGIuaGVpZ2h0OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIEgoYSkgewogICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoYSAqIE1hdGgucmFuZG9tKCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxldCBJID0gKGEsIGIsIGMsIGQsIGUpID0+IHsKICAgICAgICAgICAgICAgIGZvciAoOyBiIDw9IGQ7IGIrKykgZm9yIChsZXQgZCA9IGE7IGQgPD0gYzsgZCsrKSBlKGQsIGIpOwogICAgICAgICAgICB9OwogICAgICAgICAgICBhc3luYyBmdW5jdGlvbiBKKGEsIGIsIGMpIHsKICAgICAgICAgICAgICAgIGxldCBkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7CiAgICAgICAgICAgICAgICBkLndpZHRoID0gYTsKICAgICAgICAgICAgICAgIGQuaGVpZ2h0ID0gYjsKICAgICAgICAgICAgICAgIGF3YWl0IGMoZC5nZXRDb250ZXh0KCIyZCIpKTsKICAgICAgICAgICAgICAgIGxldCBlID0gYXdhaXQgbmV3IFByb21pc2UoKGEpID0+IGQudG9CbG9iKGEpKTsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgoYSkgPT4gewogICAgICAgICAgICAgICAgICAgIGxldCBiID0gbmV3IEltYWdlKCk7CiAgICAgICAgICAgICAgICAgICAgYi5vbmxvYWQgPSAoKSA9PiBhKGIpOwogICAgICAgICAgICAgICAgICAgIGIuc3JjID0gVVJMLmNyZWF0ZU9iamVjdFVSTChlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIEVhKGEsIGIpIHsKICAgICAgICAgICAgICAgIGxldCBbLCBjLCBkXSA9IC9eKFx3KylcKCguKilcKSQvLmV4ZWMoYSk7CiAgICAgICAgICAgICAgICByZXR1cm4gYCR7Y30oJHtkfSwke2J9KWA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYXN5bmMgZnVuY3Rpb24gSygpIHsKICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChhKSA9PiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoYSkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIEwoYSwgYiwgYywgZCkgewogICAgICAgICAgICAgICAgbGV0IGUgPSB7fTsKICAgICAgICAgICAgICAgIGEuZm9yRWFjaCgoYSkgPT4gewogICAgICAgICAgICAgICAgICAgIHZhciBmID0gYS5zbGljZSgxKS5qb2luKCJ8Iik7CiAgICAgICAgICAgICAgICAgICAgZVtmXSB8fCAoZVtmXSA9IGMoNDQwICogTWF0aC5wb3coMiwgYVsxXSAvIDEyKSwgLi4uYS5zbGljZSgyKSkpOwogICAgICAgICAgICAgICAgICAgIGYgPSBlW2ZdOwogICAgICAgICAgICAgICAgICAgIHZhciByID0gYjsKICAgICAgICAgICAgICAgICAgICBhID0gTWF0aC5yb3VuZCgodi5zYW1wbGVSYXRlICogYVswXSAqIDYwKSAvIGQpOwogICAgICAgICAgICAgICAgICAgIEFycmF5LmlzQXJyYXkoZikgfHwgKGYgPSBbZl0pOwogICAgICAgICAgICAgICAgICAgIEFycmF5LmlzQXJyYXkocikgfHwgKHIgPSBbcl0pOwogICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGIgPSAwOyBiIDwgci5sZW5ndGg7IGIrKykgewogICAgICAgICAgICAgICAgICAgICAgICBsZXQgYyA9IGZbYiAlIGYubGVuZ3RoXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSByW2IgJSByLmxlbmd0aF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gTWF0aC5taW4oYSArIGMubGVuZ3RoLCBkLmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGIgPSBhOyBiIDwgZTsgYisrKSBkW2JdICs9IGNbYiAtIGFdOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIE0oYSwgYiwgYykgewogICAgICAgICAgICAgICAgbGV0IGQgPSBbXTsKICAgICAgICAgICAgICAgIGZvciAobGV0IGUgPSAwOyBlIDwgYzsgZSsrKQogICAgICAgICAgICAgICAgICAgIGEuZm9yRWFjaCgoW2EsIC4uLmNdKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGQucHVzaChbYSArIGIgKiBlLCAuLi5jXSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm4gZDsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBOKGEsIGIpIHsKICAgICAgICAgICAgICAgIHJldHVybiBhLm1hcCgoYSwgZCkgPT4gW2EsIGJbZF1dKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBQKGEsIGIpIHsKICAgICAgICAgICAgICAgIGEuZm9yRWFjaCgoYSkgPT4gewogICAgICAgICAgICAgICAgICAgIGFbMF0gKz0gYjsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuIGE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYXN5bmMgZnVuY3Rpb24gRmEoYSwgYikgewogICAgICAgICAgICAgICAgbGV0IGMgPSB2LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpOwogICAgICAgICAgICAgICAgYy5sb29wID0gITA7CiAgICAgICAgICAgICAgICBiID0gdi5jcmVhdGVCdWZmZXIoMSwgYiwgdi5zYW1wbGVSYXRlKTsKICAgICAgICAgICAgICAgIGEoYi5nZXRDaGFubmVsRGF0YSgwKSwgMTIwKTsKICAgICAgICAgICAgICAgIGMuYnVmZmVyID0gYjsKICAgICAgICAgICAgICAgIGF3YWl0IEsoKTsKICAgICAgICAgICAgICAgIHJldHVybiBjOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNsYXNzIEdhIHsKICAgICAgICAgICAgICAgIGNvbnN0cnVjdG9yKGEpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgYiA9IHYuY3JlYXRlR2FpbigpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuUGIgPSBhLm1hcCgoYSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBsZXQgYyA9IGEuc291cmNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IHYuY3JlYXRlR2FpbigpOwogICAgICAgICAgICAgICAgICAgICAgICBlLmdhaW4udmFsdWUgPSBhLnZvbHVtZTsKICAgICAgICAgICAgICAgICAgICAgICAgYy5jb25uZWN0KGUpOwogICAgICAgICAgICAgICAgICAgICAgICBlLmNvbm5lY3QoYik7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhLlcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBiID0gdi5jcmVhdGVHYWluKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLmdhaW4udmFsdWUgPSBhLlc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmNvbm5lY3QoYik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLmNvbm5lY3QoeCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgc291cmNlOiBjLCBBYzogZS5nYWluIH07CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgYi5jb25uZWN0KHcpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcGxheSgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLlBiLmZvckVhY2goKGEpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgYS5zb3VyY2Uuc3RhcnQoKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBIYShhKSB7CiAgICAgICAgICAgICAgICBsZXQgYiA9IGEgLyB2LnNhbXBsZVJhdGUsCiAgICAgICAgICAgICAgICAgICAgYyA9IDAsCiAgICAgICAgICAgICAgICAgICAgZCA9IDAsCiAgICAgICAgICAgICAgICAgICAgZTsKICAgICAgICAgICAgICAgIHJldHVybiBEKAogICAgICAgICAgICAgICAgICAgIEMoMywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBlID0gTWF0aC5yb3VuZCgoKDEgKiB5KGMpICsgMSAqIHkoYyAvIDIpICsgMC4xICogeSgyICogYykgKyAwLjAwMSAqIHkoMyAqIGMpICsgMWUtNCAqIHkoNCAqIGMpKSAvIDIuMTExKSAqIDUpIC8gNTsKICAgICAgICAgICAgICAgICAgICAgICAgYyArPSBiOwogICAgICAgICAgICAgICAgICAgICAgICBkICs9IDEgLyB2LnNhbXBsZVJhdGU7CiAgICAgICAgICAgICAgICAgICAgICAgIDEuMjVlLTQgPD0gZCAmJiAoKGMgKz0geigpICogYiAqIDAuNiksIChkIC09IDEuMjVlLTQpKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGU7CiAgICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgICAgICAgICBbMCwgMCwgMC41XSwKICAgICAgICAgICAgICAgICAgICAgICAgWzAuMDAxLCAxLCAwLjFdLAogICAgICAgICAgICAgICAgICAgICAgICBbMSwgMF0sCiAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBJYShhLCBiKSB7CiAgICAgICAgICAgICAgICB2YXIgYyA9IG5ldyBGbG9hdDMyQXJyYXkoKDMyIC8gYikgKiA2MCAqIHYuc2FtcGxlUmF0ZSk7CiAgICAgICAgICAgICAgICB2YXIgZCA9IFswLCAwLjc1LCAxLjUsIDIsIDIuNzUsIDMuNSwgNCwgNC43NSwgNS41LCA2LCA2Ljc1LCA3LjVdOwogICAgICAgICAgICAgICAgZCA9IFsKICAgICAgICAgICAgICAgICAgICAuLi5OKGQsIFs0LCA3LCAxMSwgNCwgNywgMTEsIDEyLCAxMSwgNCwgMTIsIDExLCA0XSksCiAgICAgICAgICAgICAgICAgICAgLi4uUChOKGQsIFs0LCA3LCAxMSwgNCwgNywgMTEsIDEyLCAxMSwgNCwgMTIsIDExLCA0XSksIDgpLAogICAgICAgICAgICAgICAgICAgIC4uLlAoTihkLCBbNCwgNSwgMTIsIDQsIDUsIDEyLCAxMiwgMTEsIDQsIDEyLCAxMSwgNF0pLCAxNiksCiAgICAgICAgICAgICAgICAgICAgLi4uUChOKGQsIFsyLCA3LCAxMSwgMiwgNywgMTEsIDEyLCAxMSwgMiwgMTIsIDExLCAyXSksIDI0KSwKICAgICAgICAgICAgICAgIF07CiAgICAgICAgICAgICAgICBkLnB1c2goWzMwLjUsIDE0XSk7CiAgICAgICAgICAgICAgICBMKGQsIGMsIEhhLCBiKTsKICAgICAgICAgICAgICAgIGEuc2V0KGMsIDApOwogICAgICAgICAgICAgICAgYS5zZXQoYywgYy5sZW5ndGgpOwogICAgICAgICAgICAgICAgYS5zZXQoYywgMiAqIGMubGVuZ3RoKTsKICAgICAgICAgICAgICAgIGEuc2V0KGMsIDMgKiBjLmxlbmd0aCk7CiAgICAgICAgICAgICAgICBjID0gWwogICAgICAgICAgICAgICAgICAgIFswLCAxNl0sCiAgICAgICAgICAgICAgICAgICAgWzQsIDE3XSwKICAgICAgICAgICAgICAgICAgICBbNiwgMTldLAogICAgICAgICAgICAgICAgICAgIFs4LCAyMV0sCiAgICAgICAgICAgICAgICAgICAgWzE2LCAyNF0sCiAgICAgICAgICAgICAgICAgICAgWzIwLCAyM10sCiAgICAgICAgICAgICAgICAgICAgWzIyLCAyNF0sCiAgICAgICAgICAgICAgICAgICAgWzI0LCAxOV0sCiAgICAgICAgICAgICAgICBdOwogICAgICAgICAgICAgICAgZm9yIChsZXQgYSA9IDAsIGIgPSBjLmxlbmd0aDsgYSA8IGI7IGErKykgewogICAgICAgICAgICAgICAgICAgIHZhciBbZSwgZiwgLi4ucF0gPSBjW2FdOwogICAgICAgICAgICAgICAgICAgIGMucHVzaChbZSwgZiArIDEyLCAuLi5wXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjID0gUChjLCAzMik7CiAgICAgICAgICAgICAgICBMKGMsIGEsIEhhLCBiKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBKYShhLCBiKSB7CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGEgPSBuZXcgRmxvYXQzMkFycmF5KCgzMiAvIGIpICogNjAgKiB2LnNhbXBsZVJhdGUpOwogICAgICAgICAgICAgICAgICAgIHZhciBjID0gWzAuNSwgMS4yNV0sCiAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBOKGMsIFstMTIsIC0xMl0pOwogICAgICAgICAgICAgICAgICAgIGxldCBmID0gTihjLCBbLTE1LCAtMTVdKSwKICAgICAgICAgICAgICAgICAgICAgICAgcCA9IE4oYywgWy0xOSwgLTE5XSk7CiAgICAgICAgICAgICAgICAgICAgYyA9IE4oYywgWy0xNywgLTE3XSk7CiAgICAgICAgICAgICAgICAgICAgZCA9IFsuLi5NKGQsIDIsIDQpLCAuLi5QKE0oZiwgMiwgNCksIDgpLCAuLi5QKE0ocCwgMiwgNCksIDE2KSwgLi4uUChNKGMsIDIsIDQpLCAyNCldOwogICAgICAgICAgICAgICAgICAgIEwoZCwgYSwgSGEsIGIpOwogICAgICAgICAgICAgICAgICAgIGIgPSBhOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYS5zZXQoYiwgMCk7CiAgICAgICAgICAgICAgICBhLnNldChiLCBiLmxlbmd0aCk7CiAgICAgICAgICAgICAgICBhLnNldChiLCAyICogYi5sZW5ndGgpOwogICAgICAgICAgICAgICAgYS5zZXQoYiwgMyAqIGIubGVuZ3RoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBLYShhLCBiKSB7CiAgICAgICAgICAgICAgICBiICs9IDAuMjsKICAgICAgICAgICAgICAgIGxldCBjID0gYSAvIHYuc2FtcGxlUmF0ZSwKICAgICAgICAgICAgICAgICAgICBkID0gWwogICAgICAgICAgICAgICAgICAgICAgICBbMCwgLTAuNSwgMl0sCiAgICAgICAgICAgICAgICAgICAgICAgIFswLjEsIDEsIDJdLAogICAgICAgICAgICAgICAgICAgICAgICBbMSwgLTFdLAogICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgZSA9IDAsCiAgICAgICAgICAgICAgICAgICAgZiA9IDEgLyAxLjAxOwogICAgICAgICAgICAgICAgYSA9IFsKICAgICAgICAgICAgICAgICAgICBbMCwgMF0sCiAgICAgICAgICAgICAgICAgICAgWzAuMSAvIGIsIDFdLAogICAgICAgICAgICAgICAgICAgIFsoYiAtIDAuMikgLyBiLCAwLjVdLAogICAgICAgICAgICAgICAgICAgIFsxLCAwXSwKICAgICAgICAgICAgICAgIF07CiAgICAgICAgICAgICAgICBsZXQgcCA9IFsKICAgICAgICAgICAgICAgICAgICBbMCwgMjAwLCAwLjVdLAogICAgICAgICAgICAgICAgICAgIFswLjEgLyBiLCAyZTMsIDAuNV0sCiAgICAgICAgICAgICAgICAgICAgWyhiIC0gMC4yKSAvIGIsIDFlMywgMC41XSwKICAgICAgICAgICAgICAgICAgICBbMSwgMjAwXSwKICAgICAgICAgICAgICAgIF07CiAgICAgICAgICAgICAgICByZXR1cm4gcmEoCiAgICAgICAgICAgICAgICAgICAgRCgKICAgICAgICAgICAgICAgICAgICAgICAgQyhiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgYSA9IEEoZSAlIDEsIGQpIC8gMjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgKz0gQSgoMS4wMSAqIGUpICUgMSwgZCkgLyAzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYSArPSBBKChlICogZikgJSAxLCBkKSAvIDY7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlICs9IGM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTsKICAgICAgICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICAgICAgICAgIGEKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIHAKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gTGEoYSwgYikgewogICAgICAgICAgICAgICAgdmFyIGMgPSA2MCAvIGI7CiAgICAgICAgICAgICAgICBjID0gUCgKICAgICAgICAgICAgICAgICAgICBbCiAgICAgICAgICAgICAgICAgICAgICAgIFswLCAtOCwgNCAqIGNdLAogICAgICAgICAgICAgICAgICAgICAgICBbNCwgLTcsIDIgKiBjXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzYsIC01LCAyICogY10sCiAgICAgICAgICAgICAgICAgICAgICAgIFs4LCAtMywgNCAqIGNdLAogICAgICAgICAgICAgICAgICAgICAgICBbMTIsIC0xLCAyICogY10sCiAgICAgICAgICAgICAgICAgICAgICAgIFsxNCwgMCwgMiAqIGNdLAogICAgICAgICAgICAgICAgICAgICAgICBbMTYsIDAsIDQgKiBjXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzIwLCAtMSwgMiAqIGNdLAogICAgICAgICAgICAgICAgICAgICAgICBbMjIsIDAsIDIgKiBjXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzI0LCAyLCAzICogY10sCiAgICAgICAgICAgICAgICAgICAgICAgIFsyNywgMCwgMSAqIGNdLAogICAgICAgICAgICAgICAgICAgICAgICBbMjgsIC0xLCA0ICogY10sCiAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICAgICA2NAogICAgICAgICAgICAgICAgKS5jb25jYXQoCiAgICAgICAgICAgICAgICAgICAgUCgKICAgICAgICAgICAgICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzAsIDAsIDQgKiBjXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFswLCA0LCA0ICogY10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNCwgLTEsIDIgKiBjXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs0LCAyLCAyICogY10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNiwgLTMsIDIgKiBjXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs2LCAwLCAyICogY10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbOCwgLTMsIDQgKiBjXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs4LCAwLCA0ICogY10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTIsIC0zLCAyICogY10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTIsIDAsIDIgKiBjXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxNCwgLTUsIDIgKiBjXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxNCwgLTEsIDIgKiBjXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxNiwgLTcsIDQgKiBjXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxNiwgLTMsIDQgKiBjXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyMCwgLTUsIDIgKiBjXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyMCwgLTEsIDIgKiBjXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyMiwgLTMsIDIgKiBjXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyMiwgMCwgMiAqIGNdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzI0LCAtNSwgNCAqIGNdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzI0LCAwLCA0ICogY10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjgsIC01LCA0ICogY10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjgsIC0xLCA0ICogY10sCiAgICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgICAgIDk2CiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIEwoYywgYSwgS2EsIGIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIE1hKCkgewogICAgICAgICAgICAgICAgbGV0IGEgPSBbCiAgICAgICAgICAgICAgICAgICAgICAgIFswLCA0MDAsIDAuMDddLAogICAgICAgICAgICAgICAgICAgICAgICBbMSwgODBdLAogICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgYiA9IDAsCiAgICAgICAgICAgICAgICAgICAgYywKICAgICAgICAgICAgICAgICAgICBkID0gQygwLjQsIGZ1bmN0aW9uIChkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSB5KGIpOwogICAgICAgICAgICAgICAgICAgICAgICBiICs9IEEoZCwgYSkgLyB2LnNhbXBsZVJhdGU7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjOwogICAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgICAgIGUgPSB0YShDKDAuNCwgeiksIDNlMywgMSk7CiAgICAgICAgICAgICAgICByZXR1cm4gc2EoCiAgICAgICAgICAgICAgICAgICAgRCh3YShbZCwgZV0pLCBbCiAgICAgICAgICAgICAgICAgICAgICAgIFswLCAxLCAwLjJdLAogICAgICAgICAgICAgICAgICAgICAgICBbMSwgMF0sCiAgICAgICAgICAgICAgICAgICAgXSksCiAgICAgICAgICAgICAgICAgICAgNDAwCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIE5hKGEsIGIpIHsKICAgICAgICAgICAgICAgIGxldCBjID0gUChNKFtbMV0sIFszXSwgWzVdLCBbN10sIFs3Ljc1XV0sIDgsIDgpLCA2NCk7CiAgICAgICAgICAgICAgICBMKGMsIGEsIE1hLCBiKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBPYSgpIHsKICAgICAgICAgICAgICAgIGxldCBhID0gWwogICAgICAgICAgICAgICAgICAgICAgICBbMCwgMzgwLCAwLjFdLAogICAgICAgICAgICAgICAgICAgICAgICBbMC44LCAzMF0sCiAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICAgICBiID0gMCwKICAgICAgICAgICAgICAgICAgICBjOwogICAgICAgICAgICAgICAgcmV0dXJuIEQoCiAgICAgICAgICAgICAgICAgICAgQygwLjQsIGZ1bmN0aW9uIChkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAoeShiKSArICgyICogTWF0aC5hYnMoKGIgJSAxKSAqIDIgLSAxKSAtIDEpKSAvIDI7CiAgICAgICAgICAgICAgICAgICAgICAgIGIgKz0gQShkLCBhKSAvIHYuc2FtcGxlUmF0ZTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGM7CiAgICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgICAgICAgICBbMCwgMF0sCiAgICAgICAgICAgICAgICAgICAgICAgIFswLjAxLCAxLCAwLjJdLAogICAgICAgICAgICAgICAgICAgICAgICBbMSwgMF0sCiAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBQYShhLCBiKSB7CiAgICAgICAgICAgICAgICBsZXQgYyA9IFAoTShbWzBdLCBbMi41XSwgWzRdLCBbNS41XSwgWzYuNV1dLCA4LCA4KSwgNjQpOwogICAgICAgICAgICAgICAgTChjLCBhLCBPYSwgYik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gUWEoYSwgYikgewogICAgICAgICAgICAgICAgYSA9IFsKICAgICAgICAgICAgICAgICAgICBbMCwgYiwgMC4yXSwKICAgICAgICAgICAgICAgICAgICBbMSwgMF0sCiAgICAgICAgICAgICAgICBdOwogICAgICAgICAgICAgICAgcmV0dXJuIEQoc2EoQygwLjQsIHopLCAzZTMpLCBhKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBSYShhLCBiKSB7CiAgICAgICAgICAgICAgICBsZXQgYyA9IFAoCiAgICAgICAgICAgICAgICAgICAgTSgKICAgICAgICAgICAgICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzAsIDAsIDAuMjVdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzAuNSwgMCwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgICAgIDEsCiAgICAgICAgICAgICAgICAgICAgICAgIDY0CiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICA2NAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIGMgPSBbCiAgICAgICAgICAgICAgICAgICAgLi4uYywKICAgICAgICAgICAgICAgICAgICAuLi5QKAogICAgICAgICAgICAgICAgICAgICAgICBNKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxNC4yNSwgMCwgMC41XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTUuMjUsIDAsIDAuNV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA0CiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgIDY0CiAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIF07CiAgICAgICAgICAgICAgICBMKGMsIGEsIFFhLCBiKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBRKGEpIHsKICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLnBvdygxMCwgYSAvIDIwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBhc3luYyBmdW5jdGlvbiBTYSgpIHsKICAgICAgICAgICAgICAgIGxldCBhID0gKDc2ODAgKiB2LnNhbXBsZVJhdGUpIC8gMTIwLAogICAgICAgICAgICAgICAgICAgIFtiLCBjLCBkLCBlLCBmLCBwXSA9IGF3YWl0IFByb21pc2UuYWxsKFtJYSwgSmEsIExhLCBOYSwgUGEsIFJhXS5tYXAoKGIpID0+IEZhKGIsIGEpKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEdhKFsKICAgICAgICAgICAgICAgICAgICB7IHNvdXJjZTogYiwgdm9sdW1lOiBRKC0xNCksIFc6IDEgfSwKICAgICAgICAgICAgICAgICAgICB7IHNvdXJjZTogYywgdm9sdW1lOiBRKC0xNCksIFc6IDEgfSwKICAgICAgICAgICAgICAgICAgICB7IHNvdXJjZTogZCwgdm9sdW1lOiBRKC0xNCksIFc6IDEgfSwKICAgICAgICAgICAgICAgICAgICB7IHNvdXJjZTogZSwgdm9sdW1lOiBRKC03LjEpLCBXOiBRKC02KSB9LAogICAgICAgICAgICAgICAgICAgIHsgc291cmNlOiBmLCB2b2x1bWU6IFEoLTQuOSksIFc6IDAgfSwKICAgICAgICAgICAgICAgICAgICB7IHNvdXJjZTogcCwgdm9sdW1lOiBRKC0yMyksIFc6IDAgfSwKICAgICAgICAgICAgICAgIF0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxldCBUYSwgVWEsIFZhLCBXYSwgWGEsIFlhLCBaYSwgJGEsIGFiLCBiYiwgY2I7CiAgICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIGRiKGEpIHsKICAgICAgICAgICAgICAgIGEgPSBhKCk7CiAgICAgICAgICAgICAgICBsZXQgYiA9IHYuY3JlYXRlQnVmZmVyKDEsIGEubGVuZ3RoLCB2LnNhbXBsZVJhdGUpOwogICAgICAgICAgICAgICAgYi5nZXRDaGFubmVsRGF0YSgwKS5zZXQoYSk7CiAgICAgICAgICAgICAgICBhd2FpdCBLKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gYjsKICAgICAgICAgICAgfQogICAgICAgICAgICBhc3luYyBmdW5jdGlvbiBlYigpIHsKICAgICAgICAgICAgICAgIGxldCBhID0gdi5jcmVhdGVDb252b2x2ZXIoKSwKICAgICAgICAgICAgICAgICAgICBiID0gRGEoKSwKICAgICAgICAgICAgICAgICAgICBjID0gdi5jcmVhdGVCdWZmZXIoMiwgYlswXS5sZW5ndGgsIHYuc2FtcGxlUmF0ZSk7CiAgICAgICAgICAgICAgICBjLmdldENoYW5uZWxEYXRhKDApLnNldChiWzBdKTsKICAgICAgICAgICAgICAgIGMuZ2V0Q2hhbm5lbERhdGEoMSkuc2V0KGJbMV0pOwogICAgICAgICAgICAgICAgYS5idWZmZXIgPSBjOwogICAgICAgICAgICAgICAgeCA9IGE7CiAgICAgICAgICAgICAgICB4LmNvbm5lY3Qodyk7CiAgICAgICAgICAgICAgICBhd2FpdCBLKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gZmIoYSkgewogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChiKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGMgPSBuZXcgSW1hZ2UoKTsKICAgICAgICAgICAgICAgICAgICBjLm9ubG9hZCA9ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgYS5DID0gYzsKICAgICAgICAgICAgICAgICAgICAgICAgYihhKTsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGMuc3JjID0gYS5tYTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIGdiKCkgewogICAgICAgICAgICAgICAgW1RhLCBVYSwgVmEsIFdhLCBYYV0gPSBhd2FpdCBQcm9taXNlLmFsbChbaWEsIGphLCBrYSwgbGEsIG1hXS5tYXAoZmIpKTsKICAgICAgICAgICAgICAgIGF3YWl0IEsoKTsKICAgICAgICAgICAgICAgIFtZYSwgWmEsICRhLCBhYiwgYmJdID0gYXdhaXQgUHJvbWlzZS5hbGwoW3lhLCB6YSwgQWEsIEJhLCBDYV0ubWFwKGRiKSk7CiAgICAgICAgICAgICAgICBlYigpOwogICAgICAgICAgICAgICAgY2IgPSBhd2FpdCBTYSgpOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCJsb2FkaW5nIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IFIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJjYW52YXMiKSwKICAgICAgICAgICAgICAgIFMgPSBSLmdldENvbnRleHQoIjJkIik7CiAgICAgICAgICAgIFMuaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gITE7CiAgICAgICAgICAgIHZhciBUID0gWzEsIDAsIDAsIDEsIDAsIDBdOwogICAgICAgICAgICBmdW5jdGlvbiBVKGEpIHsKICAgICAgICAgICAgICAgIGEgPSAoMTAwICogbS5zY2FsZSkgLyBhOwogICAgICAgICAgICAgICAgVFswXSA9IGE7CiAgICAgICAgICAgICAgICBUWzNdID0gYTsKICAgICAgICAgICAgICAgIFRbNF0gPSBSLndpZHRoIC8gMiAtIG0ueCAqIGE7CiAgICAgICAgICAgICAgICBUWzVdID0gUi5oZWlnaHQgLyAyIC0gbS55ICogYTsKICAgICAgICAgICAgICAgIFMuc2V0VHJhbnNmb3JtKC4uLlQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFYoKSB7CiAgICAgICAgICAgICAgICBTLmdsb2JhbEFscGhhID0gMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBXKC4uLmEpIHsKICAgICAgICAgICAgICAgIFMuZHJhd0ltYWdlKC4uLmEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFgoYSwgYiwgYywgZCwgZSkgewogICAgICAgICAgICAgICAgUy5maWxsU3R5bGUgPSBhOwogICAgICAgICAgICAgICAgUy5maWxsUmVjdChiLCBjLCBkLCBlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBoYihhLCBiLCBjLCBkLCBlKSB7CiAgICAgICAgICAgICAgICBTLmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgUy5hcmMoYywgZCwgZSwgMCwgMiAqIE1hdGguUEkpOwogICAgICAgICAgICAgICAgYSAmJiAoKFMuZmlsbFN0eWxlID0gYSksIFMuZmlsbCgpKTsKICAgICAgICAgICAgICAgIGIgJiYgKChTLnN0cm9rZVN0eWxlID0gYiksIFMuc3Ryb2tlKCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGliKGEsIGIsIGMsIGQgPSAwLCBlID0gMSwgZiA9IDEsIHAgPSAwKSB7CiAgICAgICAgICAgICAgICBqYihiLCBjLCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgUy5yb3RhdGUocCk7CiAgICAgICAgICAgICAgICAgICAgUy5zY2FsZShlLCBmKTsKICAgICAgICAgICAgICAgICAgICBsZXQgYiA9IGEuWVtkXTsKICAgICAgICAgICAgICAgICAgICBXKGEuQywgYi54LCBiLnksIGIuaSwgYi5oLCAtYi5qLCAtYi5sLCBiLmksIGIuaCk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBqYihhLCBiLCBjKSB7CiAgICAgICAgICAgICAgICBTLnNhdmUoKTsKICAgICAgICAgICAgICAgIFMudHJhbnNsYXRlKGEsIGIpOwogICAgICAgICAgICAgICAgYygpOwogICAgICAgICAgICAgICAgUy5yZXN0b3JlKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2xhc3Mga2IgewogICAgICAgICAgICAgICAgY29uc3RydWN0b3IoYSwgYikgewogICAgICAgICAgICAgICAgICAgIHRoaXMuQiA9IGE7CiAgICAgICAgICAgICAgICAgICAgdGhpcy53ID0gYjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHMoYSwgLi4uYikgewogICAgICAgICAgICAgICAgICAgIHRoaXMuQlt0aGlzLnddLnZiICYmIHRoaXMuQlt0aGlzLnddLnZiKHRoaXMpOwogICAgICAgICAgICAgICAgICAgIHRoaXMudyA9IGE7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5CW3RoaXMud10uTiAmJiB0aGlzLkJbdGhpcy53XS5OKC4uLmIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZigpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLkJbdGhpcy53XS5BICYmIHRoaXMuQlt0aGlzLnddLkEodGhpcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2xhc3MgbGIgZXh0ZW5kcyBrYiB7CiAgICAgICAgICAgICAgICBjb25zdHJ1Y3RvcihhKSB7CiAgICAgICAgICAgICAgICAgICAgc3VwZXIoCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFswXTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEE6ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hbHBoYSA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMV06IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOOiAoYikgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmcgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgYyA9IC0wLjUgKyBNYXRoLnJhbmRvbSgpICsgKDEgPT09IGIuSSA/IE1hdGguUEkgOiAwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS54ID0gYS5LYiA9IGIueCArIDIwICogTWF0aC5jb3MoYyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEueSA9IGEuTGIgPSBiLnkgKyAyMCAqIE1hdGguc2luKGMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnJvdGF0aW9uID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5NID0gYjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEE6ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nICs9IGc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBiID0gMC4xICsgMyAqIGcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gdGhpcy5nIC8gYjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYyAqPSAyIC0gYzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGQgPSBhLk0ueSArIGEuR2E7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEueCA9IGEuS2IgKyAoYS5NLnggKyBhLmhiIC0gYS5LYikgKiBjOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnkgPSBhLkxiICsgKGQgLSBhLkxiKSAqIGM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuYWxwaGEgPSBjOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmcgPj0gYiAmJiB0aGlzLnMoMik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMl06IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBOiAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEueCA9IGEuTS54ICsgYS5oYjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS55ID0gYS5NLnkgKyBhLkdhOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnJvdGF0aW9uID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFszXTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE46ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nID0gMjA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEucm90YXRpb24gPSBNYXRoLlBJIC8gMjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEE6ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS54ID0gYS5NLnggKyBhLmhiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnkgPSBhLk0ueSArIGEuR2E7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBiID0gdGhpcy5nIC8gMjA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEucm90YXRpb24gPSAoKC1FKGEuSSkgKiBNYXRoLlBJKSAvIDIpICogYiAqIGI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZy0tOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwID09IHRoaXMuZyAmJiB0aGlzLnMoMik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNF06IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOOiAoYiwgYykgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLk0gPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmEgPSBiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmIgPSBjOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1jID0gNCAqIE1hdGgucmFuZG9tKCkgLSAyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQTogKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnggKz0gdGhpcy5hICogZzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS55ICs9IHRoaXMuYiAqIGc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEucm90YXRpb24gKz0gdGhpcy5tYyAqIGc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuYWxwaGEgPSBGKGEuYWxwaGEsIDAsIDIgKiBnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCA+PSBhLmFscGhhICYmIHRoaXMucygwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgMAogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2xhc3MgbWIgewogICAgICAgICAgICAgICAgY29uc3RydWN0b3IoYSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMueSA9IHRoaXMueCA9IDA7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5JID0gdGhpcy5YID0gYTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnJvdGF0aW9uID0gMDsKICAgICAgICAgICAgICAgICAgICB0aGlzLmhiID0gLTIgKiBhOwogICAgICAgICAgICAgICAgICAgIHRoaXMuR2EgPSAtNjsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFscGhhID0gMDsKICAgICAgICAgICAgICAgICAgICB0aGlzLkIgPSBuZXcgbGIodGhpcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBNYShhKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5NICE9PSBhICYmIHRoaXMuQi5zKDEsIGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgSGEoYSwgYikgewogICAgICAgICAgICAgICAgICAgIDAgIT09IHRoaXMuQi53ICYmIHRoaXMuQi5zKDQsIGEsIGIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZigpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLkkgKz0gKHRoaXMuWCAtIHRoaXMuSSkgLyA1OwogICAgICAgICAgICAgICAgICAgIHRoaXMuQi5mKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBiYihhKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5NICYmICh0aGlzLkdhID0gYSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBUYSgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLkIucygzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGMoKSB7CiAgICAgICAgICAgICAgICAgICAgMCA+PSB0aGlzLmFscGhhIHx8ICgoUy5nbG9iYWxBbHBoYSA9IHRoaXMuYWxwaGEpLCBpYihYYSwgdGhpcy54LCB0aGlzLnksIDAsIHRoaXMuSSwgMSwgdGhpcy5yb3RhdGlvbiksIFYoKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2xhc3MgbmIgewogICAgICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5tID0gW25ldyBtYigtMSksIG5ldyBtYigxKV07CiAgICAgICAgICAgICAgICAgICAgdGhpcy5CYSA9IFswLCAxXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIE1hKGEpIHsKICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBiIG9mIHRoaXMubSkgYi5NYShhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIEhhKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBjIG9mIHRoaXMubSkgYy5IYShhLCBiKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIFRhKCkgewogICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGEgb2YgdGhpcy5tKSBhLlRhKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBmKCkgewogICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGEgb2YgdGhpcy5tKSBhLmYoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJiKGEpIHsKICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBiIG9mIHRoaXMubSkgYi5iYihhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIG5jKGEpIHsKICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5CYSA9IFswLCAxXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubVswXS5YID0gLTE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1bMV0uWCA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAtMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuQmEgPSBbMSwgMF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1bMF0uWCA9IC0xOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tWzFdLlggPSAtMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAodGhpcy5CYSA9IFswLCAxXSksICh0aGlzLm1bMF0uWCA9IDEpLCAodGhpcy5tWzFdLlggPSAxKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjKCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuQmEuZm9yRWFjaCgoYSkgPT4gdGhpcy5tW2FdLmMoKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gWShhLCBiID0gMSwgYyA9ICExKSB7CiAgICAgICAgICAgICAgICBsZXQgZCA9IHYuY3JlYXRlQnVmZmVyU291cmNlKCk7CiAgICAgICAgICAgICAgICBkLmJ1ZmZlciA9IGE7CiAgICAgICAgICAgICAgICBjICYmICgoYSA9IHYuY3JlYXRlR2FpbigpKSwgKGEuZ2Fpbi52YWx1ZSA9IDIgKiBiKSwgZC5jb25uZWN0KGEpLCBhLmNvbm5lY3QoeCkpOwogICAgICAgICAgICAgICAgaWYgKDEgIT09IGIpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgYSA9IHYuY3JlYXRlR2FpbigpOwogICAgICAgICAgICAgICAgICAgIGEuZ2Fpbi5zZXRWYWx1ZUF0VGltZShiLCAwKTsKICAgICAgICAgICAgICAgICAgICBkLmNvbm5lY3QoYSk7CiAgICAgICAgICAgICAgICAgICAgZC5vbmVuZGVkID0gKCkgPT4gYS5kaXNjb25uZWN0KHcpOwogICAgICAgICAgICAgICAgICAgIGEuY29ubmVjdCh3KTsKICAgICAgICAgICAgICAgIH0gZWxzZSBkLmNvbm5lY3Qodyk7CiAgICAgICAgICAgICAgICBkLnN0YXJ0KCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2xhc3Mgb2IgewogICAgICAgICAgICAgICAgY29uc3RydWN0b3IoYSwgYiwgYykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuY29sb3IgPSBhOwogICAgICAgICAgICAgICAgICAgIGEgPSBNYXRoLnJhbmRvbSgpICogTWF0aC5QSSAqIDI7CiAgICAgICAgICAgICAgICAgICAgdGhpcy54ID0gTWF0aC5jb3MoYSkgKiBjOwogICAgICAgICAgICAgICAgICAgIHRoaXMueSA9IE1hdGguc2luKGEpICogYzsKICAgICAgICAgICAgICAgICAgICB0aGlzLkFhID0gYjsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFscGhhID0gMDsKICAgICAgICAgICAgICAgICAgICB0aGlzLk5iID0gMSAvIGI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjKCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuQWEtLTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFscGhhICs9IHRoaXMuTmI7CiAgICAgICAgICAgICAgICAgICAgMCA+PSB0aGlzLkFhIHx8IChoYih0aGlzLmNvbG9yLCBudWxsLCB0aGlzLngsIHRoaXMueSwgdGhpcy5BYSksIChTLmdsb2JhbEFscGhhID0gdGhpcy5hbHBoYSksIGhiKCIjODg4IiwgbnVsbCwgdGhpcy54LCB0aGlzLnksIHRoaXMuQWEpLCBWKCkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNsYXNzIHBiIHsKICAgICAgICAgICAgICAgIGNvbnN0cnVjdG9yKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnggPSBhOwogICAgICAgICAgICAgICAgICAgIHRoaXMueSA9IGI7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5nID0gMDsKICAgICAgICAgICAgICAgICAgICB0aGlzLlFiID0gWwogICAgICAgICAgICAgICAgICAgICAgICB7IHVhOiBuZXcgb2IoIiNkNDg2MjEiLCAxOCwgMCksIEZhOiAwIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsgdWE6IG5ldyBvYigiI2ZmZjJhYSIsIDksIDgpLCBGYTogMC4xIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsgdWE6IG5ldyBvYigiI2Q0ODYyMSIsIDksIDcpLCBGYTogMC4yIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHsgdWE6IG5ldyBvYigiI2ZmZjJhYSIsIDksIDYpLCBGYTogMC4zIH0sCiAgICAgICAgICAgICAgICAgICAgXTsKICAgICAgICAgICAgICAgICAgICBtLkphKDEpOwogICAgICAgICAgICAgICAgICAgIFkoYWIpOwogICAgICAgICAgICAgICAgICAgIGsuU2EgPSAyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZigpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmcgKz0gZzsKICAgICAgICAgICAgICAgICAgICAxIDw9IHRoaXMuZyAmJiBrLmpjKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjKCkgewogICAgICAgICAgICAgICAgICAgIGpiKHRoaXMueCwgdGhpcy55LCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuUWIuZm9yRWFjaCgoYSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nIDwgYS5GYSB8fCBhLnVhLmMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2xhc3MgcWIgewogICAgICAgICAgICAgICAgY29uc3RydWN0b3IoYSwgYikgewogICAgICAgICAgICAgICAgICAgIHRoaXMueCA9IGE7CiAgICAgICAgICAgICAgICAgICAgdGhpcy55ID0gYjsKICAgICAgICAgICAgICAgICAgICB0aGlzLksgPSBIKFZhLlkubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmcgPSAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZigpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmcgLT0gZzsKICAgICAgICAgICAgICAgICAgICAwID49IHRoaXMuZyAmJiBrLmdjKHRoaXMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYygpIHsKICAgICAgICAgICAgICAgICAgICBTLmdsb2JhbEFscGhhID0gMC41ICogdGhpcy5nOwogICAgICAgICAgICAgICAgICAgIGliKFZhLCB0aGlzLngsIHRoaXMueSwgdGhpcy5LKTsKICAgICAgICAgICAgICAgICAgICBWKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2xhc3MgcmIgewogICAgICAgICAgICAgICAgY29uc3RydWN0b3IoYSwgYikgewogICAgICAgICAgICAgICAgICAgIHRoaXMuY29sb3IgPSBhOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxwaGEgPSBiOwogICAgICAgICAgICAgICAgICAgIHRoaXMudWMgPSAxIC0gYjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGYoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbHBoYSA9IEYodGhpcy5hbHBoYSwgdGhpcy51YywgZyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjKCkgewogICAgICAgICAgICAgICAgICAgIFMuZ2xvYmFsQWxwaGEgPSB0aGlzLmFscGhhOwogICAgICAgICAgICAgICAgICAgIFgodGhpcy5jb2xvciwgMCwgMCwgUi53aWR0aCwgUi5oZWlnaHQpOwogICAgICAgICAgICAgICAgICAgIFYoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBsZXQgc2IgPSAwOwogICAgICAgICAgICBjbGFzcyB0YiB7CiAgICAgICAgICAgICAgICBjb25zdHJ1Y3RvcihhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy54ID0gYTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnkgPSBiOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxwaGEgPSAwOwogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5kZXggPSBzYisrICUgVGEuWS5sZW5ndGg7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjKCkgewogICAgICAgICAgICAgICAgICAgIFMuZ2xvYmFsQWxwaGEgPSB0aGlzLmFscGhhOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYWxwaGEgKz0gMC4xOwogICAgICAgICAgICAgICAgICAgIGliKFRhLCB0aGlzLngsIHRoaXMueSwgdGhpcy5pbmRleCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IHViID0gWzEsIDIsIDMsIDUsIDhdOwogICAgICAgICAgICBjbGFzcyB2YiB7CiAgICAgICAgICAgICAgICBjb25zdHJ1Y3RvcihhKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kYiA9IGE7CiAgICAgICAgICAgICAgICAgICAgdGhpcy50YSA9IGwueDsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFhID0gbC55IC0gNjsKICAgICAgICAgICAgICAgICAgICB0aGlzLmcgPSAwOwogICAgICAgICAgICAgICAgICAgIHRoaXMubmIgPSBbXTsKICAgICAgICAgICAgICAgICAgICB0aGlzLkJiID0gW107CiAgICAgICAgICAgICAgICAgICAgZm9yIChhID0gMDsgNSA+IGE7IGErKykgdGhpcy5CYi5wdXNoKHsgcjogMCwgcmE6IDAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBmKCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZysrOwogICAgICAgICAgICAgICAgICAgIHRoaXMuJGIgfHwgKDYwID09IHRoaXMuZyAmJiBrLklhKG5ldyByYigiI2ZmZiIsIDApKSwgMTIwID09IHRoaXMuZyAmJiBoLmFjKCkpOwogICAgICAgICAgICAgICAgICAgIGlmICgxMCA8IHRoaXMuZyAmJiAyNDAgPiB0aGlzLmcpCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGIgPSAwOyA1ID4gYjsgYisrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IHRoaXMuQmJbYl07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnIgKz0gMjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEucmEgKz0gdWJbYl0gKiAoMSAtIHRoaXMuZyAvIDI0MCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgYyA9IGwueCArIE1hdGguY29zKGEucmEpICogYS5yOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA9IGwueSArIE1hdGguc2luKGEucmEpICogYS5yOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgay5GKGMgLSAxLCBhIC0gMSwgMiwgMikgJiYgdGhpcy5uYi5wdXNoKG5ldyB0YihjLCBhKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGMoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5uYi5mb3JFYWNoKChhKSA9PiBhLmMoKSk7CiAgICAgICAgICAgICAgICAgICAgVigpOwogICAgICAgICAgICAgICAgICAgIFMubGluZVdpZHRoID0gMTsKICAgICAgICAgICAgICAgICAgICBoYihudWxsLCAiI2ZmZiIsIHRoaXMudGEsIHRoaXMuYWEsIE1hdGgucG93KHRoaXMuZywgMS4xMjUpKTsKICAgICAgICAgICAgICAgICAgICBoYihudWxsLCAiI2ZmZiIsIHRoaXMudGEsIHRoaXMuYWEsIE1hdGgucG93KHRoaXMuZywgMS4yNSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGxldCB3YiA9IFMuY3JlYXRlUmFkaWFsR3JhZGllbnQoUi53aWR0aCAvIDIsIFIuaGVpZ2h0IC8gMiwgMjAwLCBSLndpZHRoIC8gMiwgUi5oZWlnaHQgLyAyLCAxZTMpOwogICAgICAgICAgICB3Yi5hZGRDb2xvclN0b3AoMCwgIiNlZWVlZWUwMCIpOwogICAgICAgICAgICB3Yi5hZGRDb2xvclN0b3AoMSwgIiNlZWVlZWU1MyIpOwogICAgICAgICAgICBjbGFzcyB4YiB7CiAgICAgICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFscGhhID0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGYoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbHBoYSAtPSAyICogZzsKICAgICAgICAgICAgICAgICAgICAwID4gdGhpcy5hbHBoYSAmJiBrLmhjKHRoaXMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYygpIHsKICAgICAgICAgICAgICAgICAgICBTLmdsb2JhbEFscGhhID0gdGhpcy5hbHBoYTsKICAgICAgICAgICAgICAgICAgICBYKHdiLCAwLCAwLCBSLndpZHRoLCBSLmhlaWdodCk7CiAgICAgICAgICAgICAgICAgICAgVigpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNsYXNzIFogewogICAgICAgICAgICAgICAgY29uc3RydWN0b3IoYSwgYiwgYyA9IDEsIGQgPSAxKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy54ID0gOCAqIGE7CiAgICAgICAgICAgICAgICAgICAgdGhpcy55ID0gOCAqIGI7CiAgICAgICAgICAgICAgICAgICAgdGhpcy53aWR0aCA9IDggKiBjOwogICAgICAgICAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gOCAqIGQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBnZXQgbGIoKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMueCAvIDg7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBnZXQgUGEoKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMueSAvIDg7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBmKCkge30KICAgICAgICAgICAgICAgIGMoKSB7fQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNsYXNzIHliIHsKICAgICAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge30KICAgICAgICAgICAgICAgIHN0YXJ0KGEpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZSA9ICEwOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZyA9IGE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBzdG9wKCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZyA9IDA7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmUgPSAhMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGYoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmUgJiYgKHRoaXMuZy0tLCAwID49IHRoaXMuZyAmJiAodGhpcy5hY3RpdmUgPSAhMSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNsYXNzIHpiIGV4dGVuZHMga2IgewogICAgICAgICAgICAgICAgY29uc3RydWN0b3IoYSkgewogICAgICAgICAgICAgICAgICAgIHN1cGVyKAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMF06IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOOiAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEudmEoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEE6ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5KICYmIHRoaXMucygxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxXTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE46ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS52YSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQTogKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0WzE2XSAmJiB0aGlzLnMoMik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMl06IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOOiAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuUWEgPSAwLjE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuT2IoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEE6ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdFsxNl0gPyAoKHRoaXMuUWEgLT0gZyksIDAgPj0gdGhpcy5RYSAmJiB0aGlzLnMoMykpIDogdGhpcy5zKDEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzNdOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQTogKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0WzE2XSB8fCA0ID09PSBhLmVhLncgfHwgdGhpcy5zKDEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAwCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIFRiKCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMucygwKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjbGFzcyBBYiBleHRlbmRzIGtiIHsKICAgICAgICAgICAgICAgIGNvbnN0cnVjdG9yKGEpIHsKICAgICAgICAgICAgICAgICAgICBzdXBlcigKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzVdOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQTogKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLkogJiYgKCh0aGlzLkxhID0gMCksIGEuaWMoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuTmEgPyB0aGlzLnNiKGEpIHx8IGEuVmEoKSA6IGEuVmEoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs0XTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE46IChiKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuU2IoYik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGEgPSAwLjI1OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtMjQwID09IGEuYiAmJiAodGhpcy5sYSAtPSAwLjA2KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS54YS5hY3RpdmUgPyBhLm0uVGEoKSA6ICh0aGlzLkxhKyssIGEuYmMoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGsuSWEobmV3IHhiKCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQTogKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxhIC09IGc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAgPj0gdGhpcy5sYSA/IHRoaXMucyg2KSA6IDAgPT09IGNhICUgMiAmJiBrLkwobmV3IHFiKGEudi54ICsgTWF0aC5yYW5kb20oKSAqIGEuJCwgYS52LnkgKyBNYXRoLnJhbmRvbSgpICogYS5oYSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzZdOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTjogKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLlVhID0gMC4wODsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5xYygpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQTogKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYS5OYSAmJiAwID09PSB0aGlzLkxhICYmIHRoaXMuc2IoYSkpIHx8IChhLlZhKCksICh0aGlzLlVhIC09IGcpLCAwID49IHRoaXMuVWEgJiYgdGhpcy5zKDUpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZiOiAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDggIT09IGEua2EgJiYgYS50YygpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICA1CiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNiKGEpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIWEuZGEuYWN0aXZlIHx8ICghYS5KICYmIDAgPCB0aGlzLkxhKSkgcmV0dXJuICExOwogICAgICAgICAgICAgICAgICAgIGxldCBiID0gKDEgKiAhIXRbMV0pIHwgKDIgKiAhIXRbMl0pIHwgKDQgKiAhIXRbNF0pIHwgKDggKiAhIXRbOF0pIHx8IDI7CiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSAhYS5GKGEueCAtIDEsIGEueSksCiAgICAgICAgICAgICAgICAgICAgICAgIGQgPSAhYS5GKGEueCwgYS55IC0gMSksCiAgICAgICAgICAgICAgICAgICAgICAgIGUgPSAhYS5GKGEueCArIDEsIGEueSk7CiAgICAgICAgICAgICAgICAgICAgYiAmPSAoMSAqIGMpIHwgKDIgKiBkKSB8ICg0ICogZSkgfCAoOCAqICFhLkopOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAwICE9PSBiICYmIDUgIT09IGIgJiYgMTAgIT09IGIgJiYgMTUgIT09IGIgPyAodGhpcy5zKDQsIGIpLCAhMCkgOiAhMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGtiKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICA0ID09PSB0aGlzLncgJiYgKChhLmthICY9IH5iKSwgMCA9PT0gYS5rYSAmJiB0aGlzLnMoNikpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNsYXNzIEJiIGV4dGVuZHMgWiB7CiAgICAgICAgICAgICAgICBjb25zdHJ1Y3RvcihhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgc3VwZXIoYSwgYik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5lYiA9IGE7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mYiA9IGI7CiAgICAgICAgICAgICAgICAgICAgdGhpcy54ICs9IDQ7CiAgICAgICAgICAgICAgICAgICAgdGhpcy55ICs9IDg7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5aID0gMzsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNhID0gODsKICAgICAgICAgICAgICAgICAgICB0aGlzLiQgPSA2OwogICAgICAgICAgICAgICAgICAgIHRoaXMuaGEgPSA4OwogICAgICAgICAgICAgICAgICAgIHRoaXMuSSA9IDE7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5WID0gdGhpcy5iID0gdGhpcy5hID0gMDsKICAgICAgICAgICAgICAgICAgICB0aGlzLm5hID0gITA7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYiA9IDAuNTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmthID0gdGhpcy5IID0gdGhpcy5HID0gMDsKICAgICAgICAgICAgICAgICAgICB0aGlzLk8gPSB0aGlzLlJhID0gNzIwOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY2MgPSAzMjA7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYSA9IG5ldyB5YigpOwogICAgICAgICAgICAgICAgICAgIHRoaXMueGEgPSBuZXcgeWIoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLm0gPSBuZXcgbmIoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLksgPSB0aGlzLmdiID0gMDsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFiID0gdGhpcy5BYiA9IDE7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5PYSA9IG5ldyB6Yih0aGlzKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmVhID0gbmV3IEFiKHRoaXMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZigpIHsKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5uYSkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMud2EpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubS5mKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNiID0gRih0aGlzLmNiLCBnLCBnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBhID0gZyAqIHRoaXMuY2I7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1vdmUodGhpcy5hICogYSwgdGhpcy5iICogYSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy55ID4gay5oZWlnaHQgKyAxMDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMuYmEoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogKCh0aGlzLkogPSB0aGlzLkYodGhpcy54LCB0aGlzLnkgKyAxKSAmJiAhdGhpcy5qYSh0aGlzLngsIHRoaXMueSArIDEsIHsgcWE6IDIgfSkpICYmIHRoaXMueGEuc3RhcnQoNCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0WzMyXSAmJiAhdVszMl0gJiYgdGhpcy5kYS5zdGFydCg0KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRbMzJdIHx8IHRoaXMuZGEuc3RvcCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5PYS5mKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVhLmYoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAgIT09IHRoaXMuYSAmJiAodGhpcy5JID0gRSh0aGlzLmEpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW92ZSh0aGlzLmEgKiBnLCB0aGlzLmIgKiBnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGEuZigpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy54YS5mKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnhjKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm0uZigpKTsKICAgICAgICAgICAgICAgICAgICBlbHNlIHRoaXMubWIuZigpLCB0aGlzLm0uZigpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgeGMoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5LID0gMDsKICAgICAgICAgICAgICAgICAgICB0aGlzLm0ubmMoRSh0aGlzLmEpKTsKICAgICAgICAgICAgICAgICAgICA0ID09PSB0aGlzLmVhLncKICAgICAgICAgICAgICAgICAgICAgICAgPyAodGhpcy5LID0gMCA9PT0gdGhpcy5hID8gMCA6IDMpCiAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy5KCiAgICAgICAgICAgICAgICAgICAgICAgID8gMTAwIDwgTWF0aC5hYnModGhpcy5hKSAmJiAoKHRoaXMuSyA9IChNYXRoLmZsb29yKHRoaXMuZ2IpICUgMikgKyAxKSwgKHRoaXMuZ2IgKz0gMC4xKSkKICAgICAgICAgICAgICAgICAgICAgICAgOiAxMDAgPCBNYXRoLmFicyh0aGlzLmEpCiAgICAgICAgICAgICAgICAgICAgICAgID8gKCh0aGlzLksgPSAxKSwgMTAwIDwgdGhpcy5iICYmICh0aGlzLksgPSA0KSkKICAgICAgICAgICAgICAgICAgICAgICAgOiAodGhpcy5LID0gMTAwIDwgdGhpcy5iID8gNSA6IDApOwogICAgICAgICAgICAgICAgICAgIGxldCBhID0gMCA+IHRoaXMuYiA/IE1hdGgubWluKDAuMSwgLXRoaXMuYiAvIDEwMCkgOiAwOwogICAgICAgICAgICAgICAgICAgIHRoaXMuQWIgPSAxIC0gYTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFiID0gMSArIDIgKiBhOwogICAgICAgICAgICAgICAgICAgIHRoaXMubS5iYihbLTgsIC03LCAtOCwgLTcsIC03LCAtOCwgLTddW3RoaXMuS10pICogdGhpcy5hYjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIE9iKCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMubS5NYSh0aGlzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZhKCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMubS5IYSgtKE1hdGgubWF4KDEwLCBNYXRoLmFicyh0aGlzLmEgLyA4KSkgKiBFKHRoaXMuYSB8fCB0aGlzLkkpKSwgLXRoaXMuYiAvIDgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYmMoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy52YSgpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuT2EuVGIoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIFNiKGEpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmthID0gYTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmIgPSB0aGlzLmEgPSAwOwogICAgICAgICAgICAgICAgICAgIGEgJiAxICYmIHRoaXMuYS0tOwogICAgICAgICAgICAgICAgICAgIGEgJiAyICYmIHRoaXMuYi0tOwogICAgICAgICAgICAgICAgICAgIGEgJiA0ICYmIHRoaXMuYSsrOwogICAgICAgICAgICAgICAgICAgIGEgJiA4ICYmIHRoaXMuYisrOwogICAgICAgICAgICAgICAgICAgIDAgIT09IHRoaXMuYSAmJiAwICE9PSB0aGlzLmIgPyAoKHRoaXMuYSAqPSAxNzApLCAodGhpcy5iICo9IDE3MCkpIDogKCh0aGlzLmEgKj0gMjQwKSwgKHRoaXMuYiAqPSAyNDApKTsKICAgICAgICAgICAgICAgICAgICAyNDAgPT0gdGhpcy5iICYmICh0aGlzLmIgPSAzMjApOwogICAgICAgICAgICAgICAgICAgIFkoWWEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgVmEoKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGEgPSAxNjAgKiAoLSEhdFsxXSArICEhdFs0XSksCiAgICAgICAgICAgICAgICAgICAgICAgIGIgPSB0aGlzLkogPyAxIDogMC41OwogICAgICAgICAgICAgICAgICAgIDAgPT09IGEKICAgICAgICAgICAgICAgICAgICAgICAgPyAodGhpcy5hID0gRih0aGlzLmEsIGEsIDgwMCAqIGIgKiBnKSkKICAgICAgICAgICAgICAgICAgICAgICAgOiAwID09PSB0aGlzLmEKICAgICAgICAgICAgICAgICAgICAgICAgPyAodGhpcy5hID0gdGhpcy5KID8gMC4xICogYSA6IEYodGhpcy5hLCBhLCA4MDAgKiBiICogZykpCiAgICAgICAgICAgICAgICAgICAgICAgIDogKDAgPCBhID8gMSA6IDAgPiBhID8gLTEgOiAwKSA9PT0gRSh0aGlzLmEpCiAgICAgICAgICAgICAgICAgICAgICAgID8gKHRoaXMuYSA9IEYodGhpcy5hLCBhLCA4MDAgKiBiICogZykpCiAgICAgICAgICAgICAgICAgICAgICAgIDogKDAgPCBhID8gMSA6IDAgPiBhID8gLTEgOiAwKSAhPT0gRSh0aGlzLmEpICYmICh0aGlzLmEgPSBGKHRoaXMuYSwgYSwgMzIwMCAqIGIgKiBnKSk7CiAgICAgICAgICAgICAgICAgICAgIXRoaXMuTmEgJiYgdGhpcy54YS5hY3RpdmUgJiYgdGhpcy5kYS5hY3RpdmUgJiYgKCh0aGlzLmIgPSAtMTI4KSwgKHRoaXMuViA9IDAuNCksIHRoaXMuZGEuc3RvcCgpLCBZKCRhKSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLkopCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoKHRoaXMuViAtPSBnKSwgMCA8IHRoaXMuViAmJiB0WzMyXSkpIHRoaXMuYiArPSAxNjAgKiBnOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICgwID49IHRoaXMuViB8fCAhdFszMl0pICh0aGlzLmIgPSBGKHRoaXMuYiwgdGhpcy5jYywgdGhpcy5PICogZykpLCAodGhpcy5WID0gMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBtb3ZlKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgYyA9IChiKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLnFhICYgMiAmJiAwLjUgPD0gTWF0aC5hYnMoYSkgPyB0aGlzLmJhKCkgOiB0aGlzLmVjKGIuYSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIGQgPSAoYSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5xYSAmIDIgPyB0aGlzLmJhKCkgOiB0aGlzLmZjKGEuYik7CiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoYSkgPiBNYXRoLmFicyhiKSA/ICh0aGlzLllhKGEsIGMpLCB0aGlzLlphKGIsIGQpKSA6ICh0aGlzLlphKGIsIGQpLCB0aGlzLllhKGEsIGMpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVjKGEgPSAwKSB7CiAgICAgICAgICAgICAgICAgICAgYSA9ICgwIDwgYSA/IDEgOiAwID4gYSA/IC0xIDogMCkgPT09IEUodGhpcy5hKSA/IGEgOiAwOwogICAgICAgICAgICAgICAgICAgIGxldCBiID0gTWF0aC5hYnMoYSAtIE1hdGguYWJzKHRoaXMuYSkpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYSA9IGE7CiAgICAgICAgICAgICAgICAgICAgMjAwIDw9IGIgJiYgKHRoaXMuRWIoKSwgdGhpcy5lYS5rYih0aGlzLCA1KSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBmYyhhID0gMCkgewogICAgICAgICAgICAgICAgICAgIGEgPSAoMCA8IGEgPyAxIDogMCA+IGEgPyAtMSA6IDApID09PSBFKHRoaXMuYikgPyBhIDogMDsKICAgICAgICAgICAgICAgICAgICBpZiAoMjMwIDw9IE1hdGguYWJzKGEgLSBNYXRoLmFicyh0aGlzLmIpKSB8fCAtMjAwID4gdGhpcy5iKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuRWIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgYSA9IC0yOyAyID49IGE7IGErKykgay5MKG5ldyBxYih0aGlzLnggKyA0ICogYSwgdGhpcy55IC0gMSAtIDIgKiBNYXRoLnJhbmRvbSgpKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGsuU2EgPSAzMjAgPT0gTWF0aC5hYnModGhpcy5iKSA/IDIgOiAxOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLlYgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVhLmtiKHRoaXMsIDEwKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdGhpcy5iID0gYTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIEViKCkgewogICAgICAgICAgICAgICAgICAgIG0uSmEoMC40KTsKICAgICAgICAgICAgICAgICAgICBZKFphLCAwLjIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWMoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5PID0gdGhpcy5SYTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHFjKCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuTyA9IDA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0YygpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLk8gPSB0aGlzLlJhOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgWWEoYSwgYikgewogICAgICAgICAgICAgICAgICAgIHRoaXMuRyArPSBhOwogICAgICAgICAgICAgICAgICAgIGEgPSBNYXRoLnJvdW5kKHRoaXMuRyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKDAgIT09IGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5HIC09IGE7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjID0gMCA8IGEgPyAxIDogMCA+IGEgPyAtMSA6IDA7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoOyAwICE9PSBhOyApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkID0gdGhpcy5GKHRoaXMueCArIGMsIHRoaXMueSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgJiYgYihkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSAodGhpcy54ICs9IGMpLCAoYSAtPSBjKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIFphKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLkggKz0gYTsKICAgICAgICAgICAgICAgICAgICBhID0gTWF0aC5yb3VuZCh0aGlzLkgpOwogICAgICAgICAgICAgICAgICAgIGlmICgwICE9PSBhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuSCAtPSBhOwogICAgICAgICAgICAgICAgICAgICAgICBsZXQgYyA9IDAgPCBhID8gMSA6IDAgPiBhID8gLTEgOiAwOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKDsgMCAhPT0gYTsgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZCA9IHRoaXMuRih0aGlzLngsIHRoaXMueSArIGMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiICYmIGIoZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgKHRoaXMueSArPSBjKSwgKGEgLT0gYyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBqYShhLCBiLCBjKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGsuamEoYSAtIHRoaXMuWiwgYiAtIHRoaXMuc2EsIHRoaXMuJCwgdGhpcy5oYSwgYyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBGKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gay5GKGEgLSB0aGlzLlosIGIgLSB0aGlzLnNhLCB0aGlzLiQsIHRoaXMuaGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZ2V0IHYoKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgeDogdGhpcy54IC0gdGhpcy5aLCB5OiB0aGlzLnkgLSB0aGlzLnNhLCB3aWR0aDogdGhpcy4kLCBoZWlnaHQ6IHRoaXMuaGEsIHRhOiB0aGlzLnggLSB0aGlzLlogKyB0aGlzLiQgLyAyLCBhYTogdGhpcy55IC0gdGhpcy5zYSArIHRoaXMuaGEgLyAyIH07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBnZXQgTmEoKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDMgPT09IHRoaXMuT2EudzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGdldCB0YigpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gNCA9PT0gdGhpcy5lYS53OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdWIoYSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBhLnkgPT09IHRoaXMueSAmJiB0aGlzLnggLSB0aGlzLlogKyB0aGlzLiQgPiBhLnggJiYgdGhpcy54IC0gdGhpcy5aIDwgYS54ICsgYS53aWR0aDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGMoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5tLmMoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLm5hID8gaWIoV2EsIHRoaXMueCwgdGhpcy55LCB0aGlzLkssIHRoaXMuSSAqIHRoaXMuQWIsIHRoaXMuYWIpIDogdGhpcy5tYi5jKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBiYSgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLm5hICYmICgodGhpcy5uYSA9ICExKSwgKHRoaXMubWIgPSBuZXcgcGIodGhpcy54LCB0aGlzLnYuYWEpKSwgdGhpcy52YSgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIG9jKCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMud2EgfHwgKCh0aGlzLndhID0gITApLCAodGhpcy5VYiA9IG5ldyB2YigpKSwgay5MKHRoaXMuVWIpLCBtLkphKDEpLCBZKGJiLCAwLjIsICEwKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2xhc3MgQ2IgewogICAgICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vID0ge307CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBLYShhKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5vW2EueCArICI7IiArIGEueV0gPSBhOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdShhLCBiLCBjID0gMCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAoYSA9IHRoaXMub1thICsgIjsiICsgYl0pID8gKGMgPyAoYS5xYSAmIGMgPyBhIDogbnVsbCkgOiBhKSA6IG51bGw7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBvYihhKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgYiBpbiB0aGlzLm8pIGEodGhpcy5vW2JdKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjbGFzcyBEYiB7CiAgICAgICAgICAgICAgICBjb25zdHJ1Y3RvcihhKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5pYSA9IHt9OwogICAgICAgICAgICAgICAgICAgIHRoaXMubyA9IGE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBhc3luYyBwYSgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLm8ub2IoKGEpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGIgPSBNYXRoLmZsb29yKGEueCAvIDYwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBNYXRoLmZsb29yKGEueSAvIDYwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBiICsgIjsiICsgYzsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pYVtkXSA9IHRoaXMuaWFbZF0gfHwgeyB4OiBiLCB5OiBjLCBvOiBbXSB9OwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlhW2RdLm8ucHVzaChhKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChPYmplY3QudmFsdWVzKHRoaXMuaWEpLm1hcCgoYSkgPT4gdGhpcy5kYyhhKSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYXN5bmMgZGMoYSkgewogICAgICAgICAgICAgICAgICAgIGEuQyA9IGF3YWl0IEooNDgwLCA0ODAsIChiKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGIudHJhbnNsYXRlKDQ4MCAqIC1hLngsIDQ4MCAqIC1hLnkpOwogICAgICAgICAgICAgICAgICAgICAgICBhLm8uZm9yRWFjaCgoYSkgPT4gYS5jKHRoaXMubywgYikpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYygpIHsKICAgICAgICAgICAgICAgICAgICBJKE1hdGguZmxvb3IobS5JYigwKSAvIDggLyA2MCksIE1hdGguZmxvb3IobS5KYigwKSAvIDggLyA2MCksIE1hdGguZmxvb3IobS5JYihSLndpZHRoIC0gMSkgLyA4IC8gNjApLCBNYXRoLmZsb29yKG0uSmIoUi5oZWlnaHQgLSAxKSAvIDggLyA2MCksIChhLCBiKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjID0gdGhpcy5pYVtgJHthfTske2J9YF07CiAgICAgICAgICAgICAgICAgICAgICAgIGMgJiYgVyhjLkMsIDQ4MCAqIGEsIDQ4MCAqIGIpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNsYXNzIEViIHsKICAgICAgICAgICAgICAgIGNvbnN0cnVjdG9yKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnogPSBhOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY29sb3IgPSBiOwogICAgICAgICAgICAgICAgICAgIGEgPSBTLmNyZWF0ZVJhZGlhbEdyYWRpZW50KFIud2lkdGggLyAyLCBSLmhlaWdodCAvIDIsIDQwMCwgUi53aWR0aCAvIDIsIFIuaGVpZ2h0IC8gMiwgMTEwMCk7CiAgICAgICAgICAgICAgICAgICAgYS5hZGRDb2xvclN0b3AoMCwgRWEoYiwgMCkpOwogICAgICAgICAgICAgICAgICAgIGEuYWRkQ29sb3JTdG9wKDEsIGIpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuWGIgPSBhOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYXN5bmMgcGEoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5DID0gYXdhaXQgSig4MCwgODAsIChhKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGEuZmlsbFN0eWxlID0gdGhpcy5jb2xvcjsKICAgICAgICAgICAgICAgICAgICAgICAgYS5iZWdpblBhdGgoKTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgYiA9IDA7IDgwID4gYjsgYisrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgYiA9IDEgKyBIKDgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSAxICsgSCg4KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEucmVjdChIKDgwIC0gYiksIEgoODAgLSBkKSwgYiwgZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgYS5maWxsKCk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjKCkgewogICAgICAgICAgICAgICAgICAgIGxldCB7IHo6IGEsIEM6IGIsIFhiOiBjIH0gPSB0aGlzOwogICAgICAgICAgICAgICAgICAgIFUoYSk7CiAgICAgICAgICAgICAgICAgICAgbGV0IGQgPSAoYSAvIDE1KSAqIDgwOwogICAgICAgICAgICAgICAgICAgIEkoTWF0aC5mbG9vcigtVFs0XSAvIFRbMF0gLyBkKSwgTWF0aC5mbG9vcigtVFs1XSAvIFRbM10gLyBkKSwgTWF0aC5mbG9vcigoUi53aWR0aCAvIFRbMF0gLSBUWzRdIC8gVFswXSkgLyBkKSwgTWF0aC5mbG9vcigoUi5oZWlnaHQgLyBUWzNdIC0gVFs1XSAvIFRbM10pIC8gZCksIChhLCBjKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIFcoYiwgYSAqIGQsIGMgKiBkLCBkLCBkKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBTLnNldFRyYW5zZm9ybSgxLCAwLCAwLCAxLCAwLCAwKTsKICAgICAgICAgICAgICAgICAgICBYKGMsIDAsIDAsIFIud2lkdGgsIFIuaGVpZ2h0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjbGFzcyBGYiB7CiAgICAgICAgICAgICAgICBhc3luYyBwYSgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLlAgPSBbbmV3IEViKDkwMCwgYWEpLCBuZXcgRWIoMzAwLCBiYSldOwogICAgICAgICAgICAgICAgICAgIGF3YWl0IFByb21pc2UuYWxsKHRoaXMuUC5tYXAoKGEpID0+IGEucGEoKSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYygpIHsKICAgICAgICAgICAgICAgICAgICBYKG4sIDAsIDAsIFIud2lkdGgsIFIuaGVpZ2h0KTsKICAgICAgICAgICAgICAgICAgICB0aGlzLlAuZm9yRWFjaCgoYSkgPT4gYS5jKCkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNsYXNzIEdiIHsKICAgICAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMubyA9IG5ldyBDYigpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuRmIgPSBuZXcgU2V0KCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5QID0geyBbMTIwXTogbmV3IFNldCgpLCBbMTAwXTogbmV3IFNldCgpLCBbNTBdOiBuZXcgU2V0KCkgfTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnlhID0gbmV3IFNldCgpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuRCA9IG5ldyBTZXQoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLkhiID0gbmV3IERiKHRoaXMubyk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5qYiA9IG5ldyBGYigpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuSWEobmV3IHJiKCIjZmZmIiwgMSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYXN5bmMgWmIoKSB7CiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5qYi5wYSgpOwogICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuSGIucGEoKTsKICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBhIG9mIHRoaXMuRCkgYS5VICYmIChhd2FpdCBhLlUoKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YygpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmhlaWdodCA9IHRoaXMud2lkdGggPSAwOwogICAgICAgICAgICAgICAgICAgIHRoaXMuby5vYigoYSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndpZHRoID0gTWF0aC5tYXgodGhpcy53aWR0aCwgOCAqIGEueCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gTWF0aC5tYXgodGhpcy5oZWlnaHQsIDggKiBhLnkpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcGMoYSkgewogICAgICAgICAgICAgICAgICAgIGwgPSBhOwogICAgICAgICAgICAgICAgICAgIHRoaXMueGIgPSBhLmViOwogICAgICAgICAgICAgICAgICAgIHRoaXMueWIgPSBhLmZiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgamMoKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgYSBvZiB0aGlzLkQpIGEucmVzZXQgJiYgYS5yZXNldCgpOwogICAgICAgICAgICAgICAgICAgIGwgPSBuZXcgQmIodGhpcy54YiwgdGhpcy55Yik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBMKGEsIGIgPSAxMDApIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLlBbYl0uYWRkKGEpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuRC5hZGQoYSk7CiAgICAgICAgICAgICAgICAgICAgYS5NYiA9IGI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBnYyhhKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5ELmRlbGV0ZShhKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLlBbYS5NYl0uZGVsZXRlKGEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWIoYSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuRmIuYWRkKGEpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuTChhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIEthKGEpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLm8uS2EoYSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBJYShhKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy55YS5hZGQoYSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBoYyhhKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy55YS5kZWxldGUoYSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBqYShhLCBiLCBjLCBkLCB7IHFhOiBlID0gNywgV2E6IGYgPSBudWxsIH0gPSB7fSkgewogICAgICAgICAgICAgICAgICAgIGlmIChlICYgMSAmJiAoZiA9IHRoaXMuRihhLCBiLCBjLCBkLCB7IFdhOiBmIH0pKSkgcmV0dXJuIGY7CiAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBNYXRoLmZsb29yKGEgLyA4KTsKICAgICAgICAgICAgICAgICAgICBmID0gTWF0aC5mbG9vcihiIC8gOCk7CiAgICAgICAgICAgICAgICAgICAgYSA9IE1hdGguZmxvb3IoKGEgKyBjIC0gMSkgLyA4KTsKICAgICAgICAgICAgICAgICAgICBiID0gTWF0aC5mbG9vcigoYiArIGQgLSAxKSAvIDgpOwogICAgICAgICAgICAgICAgICAgIGZvciAoZCA9IHA7IGQgPD0gYTsgZCsrKSBmb3IgKGMgPSBmOyBjIDw9IGI7IGMrKykgaWYgKChwID0gdGhpcy5vLnUoZCwgYywgZSkpKSByZXR1cm4gcDsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIEYoYSwgYiwgYywgZCwgeyBXYTogZSA9IG51bGwgfSA9IHt9KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSBNYXRoLmZsb29yKGEgLyA4KTsKICAgICAgICAgICAgICAgICAgICBsZXQgcCA9IE1hdGguZmxvb3IoYiAvIDgpLAogICAgICAgICAgICAgICAgICAgICAgICByID0gTWF0aC5mbG9vcigoYSArIGMgLSAxKSAvIDgpLAogICAgICAgICAgICAgICAgICAgICAgICBPID0gTWF0aC5mbG9vcigoYiArIGQgLSAxKSAvIDgpOwogICAgICAgICAgICAgICAgICAgIGZvciAoOyBmIDw9IHI7IGYrKykKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgYSA9IHA7IGEgPD0gTzsgYSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgYiA9IHRoaXMuby51KGYsIGEsIDEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGIpIHJldHVybiBiOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgZiBvZiB0aGlzLkZiKSBpZiAoZiAhPT0gZSAmJiBmLlQgJiYgRyh7IHg6IGEsIHk6IGIsIHdpZHRoOiBjLCBoZWlnaHQ6IGQgfSwgZikpIHJldHVybiBmOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZigpIHsKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5TYSkgdGhpcy5TYS0tOwogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBhIG9mIHRoaXMuRCkgYS5mKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGwgJiYgbC5mKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGEgb2YgdGhpcy55YSkgYS5mKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIG0uZigpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGMoKSB7CiAgICAgICAgICAgICAgICAgICAgUy5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgMCwgMCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5qYi5jKCk7CiAgICAgICAgICAgICAgICAgICAgVSgxMjApOwogICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGEgb2YgdGhpcy5QWzEyMF0pIGEuYygpOwogICAgICAgICAgICAgICAgICAgIFUoMTAwKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLkhiLmMoKTsKICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBhIG9mIHRoaXMuUFsxMDBdKSBhLmMoKTsKICAgICAgICAgICAgICAgICAgICBsICYmIGwuYygpOwogICAgICAgICAgICAgICAgICAgIFUoNTApOwogICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGEgb2YgdGhpcy5QWzUwXSkgYS5jKCk7CiAgICAgICAgICAgICAgICAgICAgUy5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgMCwgMCk7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgYSBvZiB0aGlzLnlhKSBhLmMoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjbGFzcyBIYiB7CiAgICAgICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZhID0gdGhpcy5DYSA9IHRoaXMuRGIgPSB0aGlzLkNiID0gdGhpcy5FYSA9IHRoaXMuRGEgPSB0aGlzLlIgPSB0aGlzLkdiID0gdGhpcy55ID0gdGhpcy54ID0gMDsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNjYWxlID0gMjsKICAgICAgICAgICAgICAgICAgICB0aGlzLmNhID0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGYoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy56YygpOwogICAgICAgICAgICAgICAgICAgIHRoaXMueWMoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLndjKCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy54ID0gdGhpcy5HYiArIHRoaXMuRGE7CiAgICAgICAgICAgICAgICAgICAgdGhpcy55ID0gdGhpcy5SICsgdGhpcy5FYTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHdjKCkgewogICAgICAgICAgICAgICAgICAgIGxldCBhID0gTWF0aC5taW4oNiwgOCAqIHRoaXMuZmEgKiB0aGlzLmZhKSwKICAgICAgICAgICAgICAgICAgICAgICAgYiA9IDIgKiBNYXRoLnJhbmRvbSgpICogTWF0aC5QSTsKICAgICAgICAgICAgICAgICAgICB0aGlzLkNhICYmICgodGhpcy5DYiA9IGEgKiBNYXRoLmNvcyhiKSksICh0aGlzLkRiID0gYSAqIE1hdGguc2luKGIpKSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5DYSA9ICF0aGlzLkNhOwogICAgICAgICAgICAgICAgICAgIHRoaXMuRGEgKz0gMC43NSAqICh0aGlzLkNiIC0gdGhpcy5EYSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5FYSArPSAwLjc1ICogKHRoaXMuRGIgLSB0aGlzLkVhKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZhID0gRih0aGlzLmZhLCAwLCBnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHljKCkgewogICAgICAgICAgICAgICAgICAgIGxldCBhID0gbC52LmFhLAogICAgICAgICAgICAgICAgICAgICAgICBiID0gdGhpcy5wYigpIC8gMTAsCiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSB0aGlzLnBiKCkgLyA2LAogICAgICAgICAgICAgICAgICAgICAgICBkID0gKGIpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuUiArPSAoYSArIGIgLSB0aGlzLlIpIC8gODsKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBsLkogPyBkKDApIDogYSA8IHRoaXMueSAtIGMgPyAodGhpcy5SID0gYSArIGMpIDogYSA+IHRoaXMueSArIGMgPyAodGhpcy5SID0gYSAtIGMpIDogYSA8IHRoaXMueSAtIGIgPyBkKGIpIDogYSA+IHRoaXMueSArIGIgJiYgZCgtYik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5SID0gTWF0aC5tYXgoMCwgTWF0aC5taW4odGhpcy5SLCBrLmhlaWdodCkpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuR2IgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihsLngsIGsud2lkdGgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHpjKCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuY2EgPSBGKHRoaXMuY2EsIDAsIGcgLyA0KTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNjYWxlID0gNCAtIDIgKiB0aGlzLmNhICogdGhpcy5jYTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIEphKGEpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZhID0gTWF0aC5taW4oMSwgdGhpcy5mYSArIGEpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuQ2EgPSAhMDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHBiKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBSLmhlaWdodCAvIHRoaXMuc2NhbGU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBJYihhKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChhIC0gUi53aWR0aCAvIDIpIC8gdGhpcy5zY2FsZSArIHRoaXMueDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIEpiKGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGEgLSBSLmhlaWdodCAvIDIpIC8gdGhpcy5zY2FsZSArIHRoaXMueTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjbGFzcyBJYiB7CiAgICAgICAgICAgICAgICBhc3luYyBsb2FkKCkgewogICAgICAgICAgICAgICAgICAgIGsgPSBuZXcgR2IoKTsKICAgICAgICAgICAgICAgICAgICBtID0gbmV3IEhiKCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5WYigpOwogICAgICAgICAgICAgICAgICAgIGF3YWl0IGsuWmIoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjbGFzcyBKYiB7CiAgICAgICAgICAgICAgICBjb25zdHJ1Y3RvcihhLCBiLCBjKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy54ID0gYTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnkgPSBiOwogICAgICAgICAgICAgICAgICAgIHRoaXMucWEgPSBjOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNsYXNzIEtiIGV4dGVuZHMgSmIgewogICAgICAgICAgICAgICAgY29uc3RydWN0b3IoYSwgYikgewogICAgICAgICAgICAgICAgICAgIHN1cGVyKGEsIGIsIDEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYyhhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgYSA9ICgoKHRoaXMueCAlIDI0KSArIDI0KSAlIDI0KSAvIDI0OwogICAgICAgICAgICAgICAgICAgIGxldCBjID0gKCgodGhpcy55ICUgMjQpICsgMjQpICUgMjQpIC8gMjQ7CiAgICAgICAgICAgICAgICAgICAgYi5nbG9iYWxBbHBoYSA9IDEgLSBhICogKDEgLSBhKSAqIGMgKiAoMSAtIGMpIC0gMC4wMSArIDAuMDIgKiBNYXRoLnJhbmRvbSgpOwogICAgICAgICAgICAgICAgICAgIGIuZmlsbFN0eWxlID0gcTsKICAgICAgICAgICAgICAgICAgICBiLmZpbGxSZWN0KDggKiB0aGlzLngsIDggKiB0aGlzLnksIDgsIDgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNsYXNzIExiIGV4dGVuZHMgSmIgewogICAgICAgICAgICAgICAgY29uc3RydWN0b3IoYSwgYikgewogICAgICAgICAgICAgICAgICAgIHN1cGVyKGEsIGIsIDMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgV2IoYSkgewogICAgICAgICAgICAgICAgICAgIGxldCBiID0gdGhpcy54LAogICAgICAgICAgICAgICAgICAgICAgICBjID0gdGhpcy55LAogICAgICAgICAgICAgICAgICAgICAgICBkID0gYS51KGIsIGMgLSAxLCAyKSB8fCBhLnUoYiwgYyArIDEsIDIpLAogICAgICAgICAgICAgICAgICAgICAgICBlID0gYS51KGIgLSAxLCBjLCAyKSB8fCBhLnUoYiArIDEsIGMsIDIpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBhLnUoYiAtIDEsIGMsIDEpICYmIGQgPyAzIDogYS51KGIgKyAxLCBjLCAxKSAmJiBkID8gMSA6IGEudShiLCBjIC0gMSwgMSkgJiYgZSA/IDAgOiBhLnUoYiwgYyArIDEsIDEpICYmIGUgPyAyIDogYS51KGIgLSAxLCBjLCAxKSA/IDMgOiBhLnUoYiArIDEsIGMsIDEpID8gMSA6IGEudShiLCBjIC0gMSwgMSkgPyAwIDogYS51KGIsIGMgKyAxLCAxKSA/IDIgOiAwOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYyhhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgYi5maWxsU3R5bGUgPSBxOwogICAgICAgICAgICAgICAgICAgIGxldCBjID0gOCAqIHRoaXMueCwKICAgICAgICAgICAgICAgICAgICAgICAgZCA9IDggKiB0aGlzLnk7CiAgICAgICAgICAgICAgICAgICAgYSA9IHRoaXMuV2IoYSk7CiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZSA9IDA7IDggPiBlOyBlICs9IDIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IChlIC8gMikgJSAyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIuZmlsbFJlY3QoYyArIGUsIGQgKyAoMiA9PT0gYSA/IGYgOiAwKSwgMSwgOCAtIGYpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChlID0gMDsgOCA+IGU7IGUgKz0gMikgKGYgPSAoZSAvIDIpICUgMiksIGIuZmlsbFJlY3QoYyArICgxID09PSBhID8gZiA6IDApLCBkICsgZSwgOCAtIGYsIDEpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBiLnN0cm9rZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNsYXNzIE1iIGV4dGVuZHMgWiB7CiAgICAgICAgICAgICAgICBjb25zdHJ1Y3RvcihhLCBiLCBjLCBkLCBlLCBmKSB7CiAgICAgICAgICAgICAgICAgICAgc3VwZXIoYSwgYiwgYywgZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5lYiA9IHRoaXMueDsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZiID0gdGhpcy55OwogICAgICAgICAgICAgICAgICAgIHRoaXMucmMgPSBlOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2MgPSBmOwogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXQoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLlQgPSAhMDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJlc2V0KCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMueCA9IHRoaXMuZWI7CiAgICAgICAgICAgICAgICAgICAgdGhpcy55ID0gdGhpcy5mYjsKICAgICAgICAgICAgICAgICAgICB0aGlzLmEgPSB0aGlzLnJjOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYiA9IHRoaXMuc2M7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5IID0gdGhpcy5HID0gMDsKICAgICAgICAgICAgICAgICAgICB0aGlzLlQgPSAhMDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGFzeW5jIFUoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5DID0gYXdhaXQgSih0aGlzLndpZHRoLCB0aGlzLmhlaWdodCwgKGEpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgSSgwLCAwLCB0aGlzLndpZHRoIC8gOCAtIDEsIHRoaXMuaGVpZ2h0IC8gOCAtIDEsIChiLCBjKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmZpbGxTdHlsZSA9IEVhKHEsIDAuOTQgLSAwLjAxICsgMC4wMiAqIE1hdGgucmFuZG9tKCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5maWxsUmVjdCg4ICogYiwgOCAqIGMsIDgsIDgpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGYoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5UID0gITE7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5HICs9IHRoaXMuYSAqIGc7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5IICs9IHRoaXMuYiAqIGc7CiAgICAgICAgICAgICAgICAgICAgbGV0IGEgPSBNYXRoLnJvdW5kKHRoaXMuRyksCiAgICAgICAgICAgICAgICAgICAgICAgIGIgPSBNYXRoLnJvdW5kKHRoaXMuSCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5HIC09IGE7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5IIC09IGI7CiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSB0aGlzLmphKHRoaXMueCArIGEsIHRoaXMueSArIGIpOwogICAgICAgICAgICAgICAgICAgIGlmIChjKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodGhpcy5hICYmIEUoYy5hKSA9PT0gLUUodGhpcy5hKSkgfHwgKHRoaXMuYiAmJiBFKGMuYikgPT09IC1FKHRoaXMuYikpKSAoYy5hICo9IC0xKSwgKGMuYiAqPSAtMSk7CiAgICAgICAgICAgICAgICAgICAgICAgIDAgPCB0aGlzLmEgPyAoYSAtPSAoKHRoaXMueCArIGEpICUgOCkgKiAyKSA6IDAgPiB0aGlzLmEgPyAoYSAtPSAyICogKCgodGhpcy54ICsgYSkgJSA4KSAtIDgpKSA6IChiID0gMCA8IHRoaXMuYiA/IGIgLSAoKHRoaXMueSArIGIpICUgOCkgKiAyIDogYiAtIDIgKiAoKCh0aGlzLnkgKyBiKSAlIDgpIC0gOCkpOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmEgKj0gLTE7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYiAqPSAtMTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYyA9IGwudWIodGhpcyk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy54ICs9IGE7CiAgICAgICAgICAgICAgICAgICAgdGhpcy55ICs9IGI7CiAgICAgICAgICAgICAgICAgICAgbC5uYSAmJgogICAgICAgICAgICAgICAgICAgICAgICAoYwogICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBsLm1vdmUoYSwgMCA+IGIgfHwgIWwudGIgPyBiIDogMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogRyhsLnYsIHRoaXMpICYmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChhCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGwuWWEoMCA8IGEgPyB0aGlzLnggKyB0aGlzLndpZHRoIC0gbC52LnggOiB0aGlzLnggLSBsLnYueCAtIGwudi53aWR0aCwgKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbC5iYSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBiICYmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwuWmEoMCA8IGIgPyB0aGlzLnkgKyB0aGlzLmhlaWdodCAtIGwudi55IDogdGhpcy55IC0gbC52LnkgLSBsLnYuaGVpZ2h0LCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsLmJhKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5UID0gITA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBqYShhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGsuRihhLCBiLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCwgeyBXYTogdGhpcyB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGMoKSB7CiAgICAgICAgICAgICAgICAgICAgVyh0aGlzLkMsIHRoaXMueCwgdGhpcy55KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBsZXQgTmIgPSAwLAogICAgICAgICAgICAgICAgT2IgPSAiI2YwMCAjZmZmICMwZjAgIzAwZiAjMGZmICNmZjAgI2YwZiIuc3BsaXQoIiAiKTsKICAgICAgICAgICAgY2xhc3MgUGIgewogICAgICAgICAgICAgICAgY29uc3RydWN0b3IoYSwgYikgewogICAgICAgICAgICAgICAgICAgIHRoaXMucWIgPSBhOwogICAgICAgICAgICAgICAgICAgIHRoaXMucmIgPSBiOwogICAgICAgICAgICAgICAgICAgIGEgPSA1ICsgMTAgKiBNYXRoLnJhbmRvbSgpOwogICAgICAgICAgICAgICAgICAgIGIgPSAyICogTWF0aC5yYW5kb20oKSAqIE1hdGguUEk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy54ID0gdGhpcy5xYiArIE1hdGguY29zKGIpICogYTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnkgPSB0aGlzLnJiICsgTWF0aC5zaW4oYikgKiBhOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYSA9IDEwICogTWF0aC5zaW4oYik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5iID0gMTAgKiAtTWF0aC5jb3MoYik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5PID0gNTAwOwogICAgICAgICAgICAgICAgICAgIHRoaXMuY29sb3IgPSBPYltOYisrICUgT2IubGVuZ3RoXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGYoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy54ICs9IHRoaXMuYSAqIGc7CiAgICAgICAgICAgICAgICAgICAgdGhpcy55ICs9IHRoaXMuYiAqIGc7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5ZYih0aGlzLk8sIHRoaXMucWIsIHRoaXMucmIpOwogICAgICAgICAgICAgICAgICAgIGwud2EgJiYgKHRoaXMuTyA9IEYodGhpcy5PLCAxMDAsIDEwMCkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgWWIoYSwgYiwgYykgewogICAgICAgICAgICAgICAgICAgIGIgPSB0aGlzLnggLSBiOwogICAgICAgICAgICAgICAgICAgIGMgPSB0aGlzLnkgLSBjOwogICAgICAgICAgICAgICAgICAgIGxldCBkID0gTWF0aC5tYXgoMSwgYiAqIGIgKyBjICogYyk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5hICs9ICgoLWEgKiBiKSAvIGQpICogZzsKICAgICAgICAgICAgICAgICAgICB0aGlzLmIgKz0gKCgtYSAqIGMpIC8gZCkgKiBnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNsYXNzIFFiIGV4dGVuZHMgWiB7CiAgICAgICAgICAgICAgICBjb25zdHJ1Y3RvcihhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgc3VwZXIoYSwgYik7CiAgICAgICAgICAgICAgICAgICAgdGhpcy56YiA9IFtdOwogICAgICAgICAgICAgICAgICAgIGZvciAoYSA9IDA7IDIwID4gYTsgYSsrKSB0aGlzLnpiLnB1c2gobmV3IFBiKHRoaXMueCArIDQsIHRoaXMueSArIDQpKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFscGhhID0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGYoKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBsLnY7CiAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBNYXRoLmFicyh0aGlzLnggKyA0IC0gYS50YSk7CiAgICAgICAgICAgICAgICAgICAgYSA9IE1hdGguYWJzKHRoaXMueSArIDQgLSBhLmFhKTsKICAgICAgICAgICAgICAgICAgICBiID0gYiAqIGIgKyBhICogYTsKICAgICAgICAgICAgICAgICAgICAyNTYgPiBiICYmIChsLnRiIHx8IDI2MCA8PSBsLmIpICYmIGwub2MoKTsKICAgICAgICAgICAgICAgICAgICBsLndhICYmICh0aGlzLmFscGhhID0gRih0aGlzLmFscGhhLCAwLCBnKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjKCkgewogICAgICAgICAgICAgICAgICAgIFMuZ2xvYmFsQWxwaGEgPSB0aGlzLmFscGhhOwogICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGEgPSAwOyAyMCA+IGE7IGErKykgewogICAgICAgICAgICAgICAgICAgICAgICBsZXQgYiA9IHRoaXMuemJbYV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogTWF0aC5yYW5kb20oKSAqIDgpOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBhID0gMDsgYSA8IGM7IGErKykgYi5mKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIFgoYi5jb2xvciwgYi54IC0gMSwgYi55IC0gMSwgMiwgMik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIFYoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBSYihhKSB7CiAgICAgICAgICAgICAgICBsZXQgYiA9IDAsCiAgICAgICAgICAgICAgICAgICAgYyA9IDAsCiAgICAgICAgICAgICAgICAgICAgZCA9IDAsCiAgICAgICAgICAgICAgICAgICAgZSA9IDA7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBmID0gMDsgZiA8IGEubGVuZ3RoOyBmKyspICIgIiA9PT0gYVtmXSA/IChkICs9IDYpIDogYVtmXS5tYXRjaCgvXG58Iy8pID8gKChkID0gMCksIChlICs9IDYpKSA6ICgoZCArPSA2KSwgKGIgPSBNYXRoLm1heChkLCBiKSksIChjID0gTWF0aC5tYXgoZSArIDYsIGMpKSk7CiAgICAgICAgICAgICAgICByZXR1cm4geyB3aWR0aDogYiwgaGVpZ2h0OiBjIH07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gU2IoYSkgewogICAgICAgICAgICAgICAgbGV0IHsgd2lkdGg6IGIsIGhlaWdodDogYyB9ID0gUmIoYSk7CiAgICAgICAgICAgICAgICByZXR1cm4gSihiICsgMSwgYyArIDEsIChkKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgZC5maWxsU3R5bGUgPSBuOwogICAgICAgICAgICAgICAgICAgIGQuZmlsbFJlY3QoMCwgMCwgYiArIDEsIGMgKyAxKTsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBiID0gMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAxOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBlID0gMDsgZSA8IGEubGVuZ3RoOyBlKyspICIgIiA9PT0gYVtlXSA/IChiICs9IDYpIDogYVtlXS5tYXRjaCgvXG58Iy8pID8gKChiID0gMSksIChjICs9IDYpKSA6IChkLmRyYXdJbWFnZShVYS5DLCA2ICogKGEuY2hhckNvZGVBdChlKSAtIDY1KSwgMCwgNSwgNSwgYiwgYywgNSwgNSksIChiICs9IDYpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjbGFzcyBUYiBleHRlbmRzIFogewogICAgICAgICAgICAgICAgY29uc3RydWN0b3IoYSwgYiwgYykgewogICAgICAgICAgICAgICAgICAgIHN1cGVyKGEsIGIpOwogICAgICAgICAgICAgICAgICAgIHRoaXMudGV4dCA9IGM7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBhc3luYyBVKCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuQyA9IGF3YWl0IFNiKHRoaXMudGV4dCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjKCkgewogICAgICAgICAgICAgICAgICAgIFcodGhpcy5DLCB0aGlzLngsIHRoaXMueSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIFViID0gWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGdhOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIDE6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFswLCAwLCA1NiwgNTBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzEyNiwgNTYsIDIzLCAzNF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTQ5LCA1NiwgMjUsIDIyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxNDksIDYzLCAzMywgMTVdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzE4MiwgNjMsIDE2LCAxMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTk4LCA2MCwgOCwgMTRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIwNiwgNTcsIDExLCAxN10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjE3LCA2MiwgMTMsIDEyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyMjIsIDc0LCAyOCwgMjRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzI1MCwgNjYsIDksIDMyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyNzAsIDc0LCAxNiwgMTZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzI4NiwgODIsIDE2LCA4XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyOTQsIDkwLCA0OCwgOF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMzAsIDUwLCA5NiwgMTBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzMwMSwgMTUsIDI1LCA0M10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMzE4LCA1OCwgOCwgMjhdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzMxOCwgNzQsIDE2LCAxMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMzM0LCA2MywgOCwgN10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMzQwLCAxNSwgMTIsIDQ2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFszNDAsIDE1LCAzMiwgNDBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzM0MiwgNjQsIDgsIDZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzM1MCwgNjMsIDExLCA3XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFszNjEsIDU4LCAyMywgMTJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzM3NCwgNjcsIDY2LCAzMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNDQwLCA2NywgMjIsIDddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzQ0NiwgMTUsIDQ4LCAzM10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNDYyLCA1OCwgOCwgMTZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzU1LCA0NSwgMjcsIDI1XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs5MiwgNjAsIDM0LCA0XSwKICAgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICAgICAgICAgMjogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIzMCwgNzMsIDIwLCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFszNDIsIDYzLCA4LCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFszNTIsIDU1LCAyMCwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMzg0LCA2NiwgMzAsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgRDogWwogICAgICAgICAgICAgICAgICAgICAgICBbMywgNTksIDQ0XSwKICAgICAgICAgICAgICAgICAgICAgICAgWzQsIDI0NiwgNjYsIDQsIDQsIC02MCwgMF0sCiAgICAgICAgICAgICAgICAgICAgICAgIFs1LCA0NjYsIDUzXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzYsIDE1NywgNDYsICJXSEFUIElTIFRIRSBDQVVTRSBPRiBUSElTXiJdLAogICAgICAgICAgICAgICAgICAgICAgICBbNiwgMTgwLCA1OSwgIlBSRVNTIFNQQUNFIFRPIEpVTVAiXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzYsIDIzMywgNTAsICJBTkQgV0hFUkUgRElEIFRIRVNFIE9CU1RBQ0xFUyBDT01FIEZST01eIl0sCiAgICAgICAgICAgICAgICAgICAgICAgIFs2LCAyOTUsIDc4LCAiSE9MRCBTSElGVCBUTyBTVU1NT04gV0lOR1MiXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzYsIDM0NCwgODIsICJVU0lORyBZT1VSIFdJTkdTXSBQUkVTUyNTUEFDRSBUTyBEQVNIIl0sCiAgICAgICAgICAgICAgICAgICAgICAgIFs2LCA0NTEsIDU3LCAiTE9PSyBBVCBUSEFUWyJdLAogICAgICAgICAgICAgICAgICAgICAgICBbNiwgNDcwLCA1NCwgIkRBU0ggVEhST1VHSCBJVCBUTyBSRUxFQVNFI1RIRSBFU1NFTkNFIE9GIFRISVMgUEFSQURJU0VbIl0sCiAgICAgICAgICAgICAgICAgICAgICAgIFs2LCA4NiwgNDAsICJQQVJBRElTRSBIQVMgQkVFTiBUVVJORUQgT0ZGTElORVxcXFxcXCJdLAogICAgICAgICAgICAgICAgICAgICAgICBbNywgMjI1LCA2MV0sCiAgICAgICAgICAgICAgICAgICAgICAgIFs3LCAzMzcsIDYyXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzcsIDMzNywgODldLAogICAgICAgICAgICAgICAgICAgICAgICBbOCwgMzM0LCA3NCwgOCwgNV0sCiAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgZ2E6IHsKICAgICAgICAgICAgICAgICAgICAgICAgMTogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzAsIDAsIDU0LCA1MF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTA2LCA0OSwgNiwgNTJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzExMiwgMCwgMjIsIDQ2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxMTgsIDQ5LCA2LCA1Ml0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTMwLCA1OSwgMzgsIDQyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxMzYsIDUwLCA4LCA1MV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTQ5LCA0NSwgMTMsIDRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzE1MywgMCwgMzgsIDM3XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxNTMsIDAsIDQyLCAzNF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTY4LCA0NSwgMTEsIDU2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxNzksIDQyLCAzLCAyNV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTc5LCA3OSwgMTMsIDIyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxODIsIDQ1LCAxNCwgMjJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzE5NiwgMzksIDMsIDI4XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxOTksIDM2LCA2LCAzMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjA1LCA0NywgMTQsIDIwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyMTIsIDY3LCA3LCAxNF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjEzLCAwLCAxMSwgMzhdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIxNiwgNDIsIDI3LCAxMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjE5LCA3NSwgNywgMTVdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIyNiwgNjMsIDYsIDZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIyNiwgODAsIDYsIDZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIyNiwgOTUsIDYsIDZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIzMiwgNjksIDcsIDZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIzMiwgODcsIDcsIDNdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIzOSwgNTgsIDM0LCAyMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjczLCAwLCAxNywgODBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzM3LCA1MCwgMTcsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs1NCwgNDIsIDEwLCAyNF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNjAsIDAsIDc0LCAyNF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNjQsIDQ3LCAxNiwgMTldLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzgwLCAzNCwgOCwgNjddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzg4LCAyNCwgMjQsIDZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzg4LCA1NSwgNDIsIDQ2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs4OCwgOTUsIDEyNCwgNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbOTQsIDM4LCA3LCA3XSwKICAgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICAgICAgICAgMjogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzEwMSwgMzgsIDEsIDddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzExMSwgMzAsIDEsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxMTIsIDQ2LCAyMiwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTEyLCA1NCwgNiwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTI0LCA1NCwgNiwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTMwLCA1OCwgNiwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTQ0LCA1OCwgMjQsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzE0OCwgNDUsIDEsIDRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzE0OSwgNDQsIDEzLCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxNDksIDQ5LCAxMywgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTUzLCAzNywgMzgsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzE2MiwgNDUsIDEsIDRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzE3OCwgNDIsIDEsIDNdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzE3OSwgNDEsIDMsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzE4MiwgNDIsIDEsIDNdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzE5MSwgMzQsIDEsIDNdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzE5MSwgMzQsIDQsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzE5MiwgNjcsIDIwLCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxOTIsIDc5LCAxLCAxNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTk1LCAzOSwgMSwgNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTk2LCAzOCwgMywgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjA1LCA0NiwgMTEsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIxMywgMzgsIDExLCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyMTksIDUyLCAyNCwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjE5LCA3NCwgNywgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjE5LCA5MCwgNywgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjI0LCAwLCAxLCAzOF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjMyLCA2OCwgNywgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjMyLCA4NiwgNywgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjMyLCA5MCwgNywgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjM5LCA1NywgMzMsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzI3MiwgMCwgMSwgNThdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzYwLCAyNCwgMjgsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzY0LCA0NiwgMTYsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzg4LCAzMCwgMjQsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzg4LCA1NCwgMTgsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzkzLCAzOCwgMSwgN10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbOTQsIDM3LCA3LCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs5NCwgNDUsIDcsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgRDogWwogICAgICAgICAgICAgICAgICAgICAgICBbMywgNTYsIDQxXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzUsIDE4MiwgNzVdLAogICAgICAgICAgICAgICAgICAgICAgICBbNywgMTM5LCA0OV0sCiAgICAgICAgICAgICAgICAgICAgICAgIFs3LCAyMzQsIDQxXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzgsIDI0MywgMzgsIDI5LCA4XSwKICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBnYTogewogICAgICAgICAgICAgICAgICAgICAgICAxOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMCwgMSwgNTAsIDUwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxMTIsIDEsIDgsIDQzXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxMTIsIDU3LCA4LCAzMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTIwLCA2NiwgMTAsIDIyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxMzAsIDc1LCA2MiwgMTNdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzEzNCwgMSwgNzEsIDU4XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxOTIsIDY2LCAyMSwgMjJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIwNSwgODgsIDgsIDldLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIxMywgNzAsIDEzLCAyN10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjI2LCA3NywgOTMsIDIwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyMzcsIDY0LCA1LCAyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyNTcsIDEsIDQsIDY1XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyODYsIDU0LCAxMywgMTJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzMwOSwgMSwgNiwgNjFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzMxOSwgNjEsIDksIDVdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzMxOSwgNzEsIDksIDI2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFszMjgsIDkyLCAyMywgNV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMzM3LCAxLCAxNCwgODZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzMzNywgMSwgNTIsIDg1XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFszNDQsIDk3LCA3LCAyMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMzUxLCAxMDYsIDQ3LCAxMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMzY1LCAxLCAzLCA5MV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMzg5LCAxLCAxMiwgMTVdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzM5NSwgNjQsIDE1LCAyMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMzk4LCA5MiwgNiwgMjZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzQwNCwgMTA1LCAxOSwgMTNdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzQwOCwgMSwgNDEsIDE1XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs0MDgsIDIzLCA0MSwgNF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNDE1LCA1NywgMzQsIDIwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs0MjMsIDI3LCAyLCA5MV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNDI1LCAxLCAyNCwgMTE3XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs1MCwgNDQsIDgsIDM1XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs1NiwgMSwgMzIsIDMyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs1OCwgNTAsIDksIDI5XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs2NywgNTksIDEzLCAyMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNzMsIDMzLCA3LCAxNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbODAsIDEsIDgsIDUzXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs4MCwgNjAsIDgsIDE5XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs4OCwgNjcsIDI0LCAxMl0sCiAgICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgICAgIDI6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxMTIsIDU2LCA4LCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyMjYsIDc2LCA5MywgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjM3LCA2MywgNSwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjg2LCA1MywgMTMsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzMxOSwgNjAsIDksIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzMxOSwgNzAsIDksIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzMyOCwgNjEsIDEsIDVdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzMyOCwgNzEsIDEsIDIxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFszMzYsIDEsIDEsIDg2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFszMzcsIDAsIDY0LCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFszNTEsIDEwNSwgNDcsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzM1MSwgODYsIDE0LCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFszNjgsIDg2LCAyMSwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMzg5LCAxNiwgMTIsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzM5NSwgNjMsIDE1LCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFszOTUsIDg2LCAxNSwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMzk4LCA5MSwgNiwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNDA4LCAwLCA0MSwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNDA4LCAxNiwgOCwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNDA4LCAyMiwgOCwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNDA4LCAyNywgMTUsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzU4LCA0OSwgOSwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNzIsIDMzLCAxLCAxNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbODAsIDU5LCA4LCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs4OCwgNjYsIDI0LCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIEQ6IFsKICAgICAgICAgICAgICAgICAgICAgICAgWzMsIDUyLCA0M10sCiAgICAgICAgICAgICAgICAgICAgICAgIFs0LCAxMTIsIDQ5LCA4LCAzLCAwLCAxMDBdLAogICAgICAgICAgICAgICAgICAgICAgICBbNCwgMTM5LCA2NSwgNSwgNywgMCwgMTIwXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzQsIDE0NCwgNjQsIDUsIDcsIDAsIDEyMF0sCiAgICAgICAgICAgICAgICAgICAgICAgIFs0LCAxNDksIDYzLCA1LCA3LCAwLCAxMjBdLAogICAgICAgICAgICAgICAgICAgICAgICBbNCwgMTU0LCA2MiwgNSwgNywgMCwgMTIwXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzQsIDE1OSwgNjEsIDUsIDcsIDAsIDEyMF0sCiAgICAgICAgICAgICAgICAgICAgICAgIFs0LCAxNjQsIDYwLCA1LCA3LCAwLCAxMjBdLAogICAgICAgICAgICAgICAgICAgICAgICBbNCwgMTc1LCA2NCwgMTQsIDEwLCAwLCAxMDBdLAogICAgICAgICAgICAgICAgICAgICAgICBbNCwgMjE1LCA2NiwgNCwgNCwgMTAwLCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzQsIDM1MSwgOTIsIDE0LCA1LCAwLCAxMDBdLAogICAgICAgICAgICAgICAgICAgICAgICBbNCwgMzY4LCA5MiwgMzAsIDUsIDAsIDEwMF0sCiAgICAgICAgICAgICAgICAgICAgICAgIFs0LCA0MDAsIDU1LCA1LCA2LCAwLCAtMjAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzQsIDQwNCwgOTIsIDE5LCA1LCAwLCAxMDBdLAogICAgICAgICAgICAgICAgICAgICAgICBbNCwgNDE5LCA3NywgNCwgNCwgLTEyMCwgMF0sCiAgICAgICAgICAgICAgICAgICAgICAgIFs0LCA1OCwgNDQsIDUsIDUsIDYwLCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzQsIDcyLCA0OSwgNSwgNSwgNjAsIDBdLAogICAgICAgICAgICAgICAgICAgICAgICBbNCwgODksIDYwLCA3LCAzLCA2MCwgMF0sCiAgICAgICAgICAgICAgICAgICAgICAgIFs1LCA0MjEsIDE5XSwKICAgICAgICAgICAgICAgICAgICAgICAgWzcsIDEyMywgNjVdLAogICAgICAgICAgICAgICAgICAgICAgICBbNywgMjA4LCA2NV0sCiAgICAgICAgICAgICAgICAgICAgICAgIFs3LCAzMzksIDkxXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzgsIDIyMiwgNjYsIDQsIDRdLAogICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGdhOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIDE6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFswLCAwLCAyNiwgMTA1XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFswLCAwLCA0MSwgNjddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzExMCwgNDQsIDE2LCAxN10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTM0LCAwLCA5NSwgNTZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzEzNCwgNTYsIDE1LCA3XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxMzQsIDcwLCA4LCAxOV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTQyLCA4MSwgNDMsIDhdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzE0OSwgMCwgMjYsIDY2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxODUsIDcwLCAxNywgMTldLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIwOCwgMCwgOCwgNzBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIxNiwgMCwgMTMsIDU5XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyMjQsIDY5LCA1LCA2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyMzksIDYxLCA1LCA3XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyNTcsIDYxLCAxMywgN10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjgzLCA2OSwgNSwgNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjk0LCAwLCA4LCA3Ml0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMzA4LCA3MCwgMTgsIDRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzMxLCA3OSwgMTUsIDRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzMxLCA4OCwgNywgMTddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzM4LCA3MywgMjQsIDVdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzM4LCA3OCwgOCwgNV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMzgsIDk3LCAzMiwgOF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNDEsIDYxLCA2LCA2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs0NywgMCwgMzMsIDQzXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs0NywgNDMsIDE1LCAxMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNTQsIDU1LCA4LCAyM10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNTQsIDg0LCA0LCA2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs2OSwgNjAsIDUsIDExXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs2OSwgNzYsIDEyLCAxMl0sCiAgICAgICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgICAgIDI6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxMzQsIDYzLCAxNSwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTM0LCA2OSwgOCwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTQyLCA4MCwgNDMsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzE4NSwgNjksIDksIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIyMywgNjksIDEsIDZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIyNCwgNjgsIDUsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIyNCwgNzUsIDUsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIyOSwgNjksIDEsIDZdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIzOCwgNjEsIDEsIDddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIzOSwgNjAsIDUsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIzOSwgNjgsIDUsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzI0NCwgNjEsIDEsIDddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzI1NiwgNjEsIDEsIDddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzI1NywgNjAsIDEzLCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsyNTcsIDY4LCAxMywgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjYsIDY3LCAxLCAzOF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjcsIDY3LCAyMCwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjcwLCA2MSwgMSwgN10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjgyLCA2OSwgMSwgNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjgzLCA2OCwgNSwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjgzLCA3NSwgNSwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMjg4LCA2OSwgMSwgNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMzEsIDc4LCA3LCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFszMSwgODMsIDE1LCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFszOCwgNzIsIDE2LCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs0NiwgOTYsIDI0LCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs0NywgNTUsIDcsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzUzLCA4NCwgMSwgNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNTQsIDgzLCA0LCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs1NCwgOTAsIDQsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzU4LCA4NCwgMSwgNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNjIsIDQzLCAxOCwgMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNjgsIDc2LCAxLCAxMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNjksIDU5LCA1LCAxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs2OSwgNzEsIDUsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzY5LCA3NSwgMTIsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzY5LCA4OCwgMTIsIDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzgxLCA3NiwgMSwgMTJdLAogICAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgRDogWwogICAgICAgICAgICAgICAgICAgICAgICBbMywgNDMsIDYwXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzQsIDE0OSwgNjYsIDMsIDQsIDYwLCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzQsIDE3MiwgNjYsIDMsIDQsIDYwLCAwXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzQsIDI1NSwgNjksIDcsIDQsIC04MCwgMF0sCiAgICAgICAgICAgICAgICAgICAgICAgIFs1LCAzMjIsIDY3XSwKICAgICAgICAgICAgICAgICAgICAgICAgWzcsIDExMiwgNDNdLAogICAgICAgICAgICAgICAgICAgICAgICBbNywgMTk3LCA2OV0sCiAgICAgICAgICAgICAgICAgICAgICAgIFs3LCA0MSwgOTZdLAogICAgICAgICAgICAgICAgICAgICAgICBbOCwgMTI2LCA1NywgOCwgNF0sCiAgICAgICAgICAgICAgICAgICAgICAgIFs4LCAxNDIsIDcwLCAzLCAzXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzgsIDE1MiwgNzAsIDMsIDNdLAogICAgICAgICAgICAgICAgICAgICAgICBbOCwgMTYyLCA3MCwgMywgM10sCiAgICAgICAgICAgICAgICAgICAgICAgIFs4LCAxNzIsIDcwLCAzLCAzXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzgsIDE4MiwgNzAsIDMsIDNdLAogICAgICAgICAgICAgICAgICAgICAgICBbOCwgMjAyLCA3NiwgMTAwLCA0XSwKICAgICAgICAgICAgICAgICAgICAgICAgWzgsIDMxLCA3MywgNywgNV0sCiAgICAgICAgICAgICAgICAgICAgICAgIFs4LCA0NywgNjEsIDcsIDNdLAogICAgICAgICAgICAgICAgICAgICAgICBbOCwgNDcsIDkyLCAzLCAzXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzgsIDYyLCA4OSwgMywgM10sCiAgICAgICAgICAgICAgICAgICAgICAgIFs4LCA2NCwgNTgsIDMsIDNdLAogICAgICAgICAgICAgICAgICAgICAgICBbOCwgNzcsIDQ3LCAzLCAzXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzgsIDc3LCA2OCwgMywgM10sCiAgICAgICAgICAgICAgICAgICAgICAgIFs4LCA3OCwgOTYsIDMsIDNdLAogICAgICAgICAgICAgICAgICAgICAgICBbOCwgODgsIDgzLCAzLCAzXSwKICAgICAgICAgICAgICAgICAgICAgICAgWzgsIDk0LCA0MiwgMywgM10sCiAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgZ2E6IHsKICAgICAgICAgICAgICAgICAgICAgICAgMTogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzAsIDAsIDQ2LCA0NV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTAzLCA2NSwgMTQsIDEwXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxMTgsIDUyLCAxMCwgOF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMTI4LCA0NCwgMTEsIDE2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxMzEsIDU3LCAyMCwgMTJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzQ2LCAzMSwgMTksIDE0XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs0NywgNjksIDE0LCAxMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbNjEsIDYxLCAyMCwgMTJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzcwLCA3MSwgMzQsIDE1XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFs5MywgNDksIDE0LCA5XSwKICAgICAgICAgICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgICAgICAgICAgMjogW10sCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBEOiBbCiAgICAgICAgICAgICAgICAgICAgICAgIFszLCA5MCwgNzBdLAogICAgICAgICAgICAgICAgICAgICAgICBbNiwgODQsIDY0LCAiVEhBTktTIEZPUiBQTEFZSU5HWyJdLAogICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICBdOwogICAgICAgICAgICBjbGFzcyBWYiB7CiAgICAgICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnRleHQgPSBuZXcgVGIoMCwgMCwgIk9GRkxJTkUgUEFSQURJU0UiKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIFUoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZXh0LnggPSBsLnggLSA0ODsKICAgICAgICAgICAgICAgICAgICB0aGlzLnRleHQueSA9IGwueSAtIDMwOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRleHQuVSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZigpIHt9CiAgICAgICAgICAgICAgICBjKCkgewogICAgICAgICAgICAgICAgICAgIFMuZ2xvYmFsQWxwaGEgPSAxIC0gKDEgLSBtLmNhKSAqICgxIC0gbS5jYSk7CiAgICAgICAgICAgICAgICAgICAgWChuLCBtLnggLSAzMDAsIG0ueSAtIDMwMCwgNjAwLCA2MDApOwogICAgICAgICAgICAgICAgICAgIHRoaXMudGV4dC5jKCk7CiAgICAgICAgICAgICAgICAgICAgVigpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGxldCBXYjsKICAgICAgICAgICAgY2xhc3MgWGIgZXh0ZW5kcyBaIHsKICAgICAgICAgICAgICAgIFUoKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5rYyA9IHRoaXMubGI7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYyA9IHRoaXMuUGE7CiAgICAgICAgICAgICAgICAgICAgbGV0IGEgPSB0aGlzLmxiLAogICAgICAgICAgICAgICAgICAgICAgICBiID0gdGhpcy5QYSwKICAgICAgICAgICAgICAgICAgICAgICAgYyA9IHRoaXMuUGE7CiAgICAgICAgICAgICAgICAgICAgZm9yICg7IC0xMCA8PSBiICYmICFrLm8udShhLCBiIC0gMSk7ICkgYi0tOwogICAgICAgICAgICAgICAgICAgIHRoaXMueSA9IDggKiBiOwogICAgICAgICAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gOCAqIChjIC0gYiArIDEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZigpIHsKICAgICAgICAgICAgICAgICAgICBXYiAhPT0gdGhpcyAmJiBHKHRoaXMsIGwudikgJiYgKChXYiA9IHRoaXMpLCAoay54YiA9IHRoaXMua2MpLCAoay55YiA9IHRoaXMubGMpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjbGFzcyBZYiBleHRlbmRzIFogewogICAgICAgICAgICAgICAgY29uc3RydWN0b3IoYSwgYiwgYywgZCkgewogICAgICAgICAgICAgICAgICAgIHN1cGVyKGEsIGIsIGMsIGQpOwogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXQoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJlc2V0KCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuVCA9ICEwOwogICAgICAgICAgICAgICAgICAgIHRoaXMuJGEgPSAhMTsKICAgICAgICAgICAgICAgICAgICB0aGlzLlMgPSAwOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYXN5bmMgVSgpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLkMgPSBhd2FpdCBKKHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCAoYSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBJKDAsIDAsIHRoaXMud2lkdGggLyA4IC0gMSwgdGhpcy5oZWlnaHQgLyA4IC0gMSwgKGIsIGMpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuZmlsbFN0eWxlID0gRWEocSwgMC45NCAtIDAuMDEgKyAwLjAyICogTWF0aC5yYW5kb20oKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmZpbGxSZWN0KDggKiBiLCA4ICogYywgOCwgOCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICBsZXQgYiA9IGEuZ2V0SW1hZ2VEYXRhKDAsIDAsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IDI7IGMgPCB0aGlzLndpZHRoIC0gMjsgYysrKSAoYi5kYXRhWzQgKiAoYyArIDEgKiB0aGlzLndpZHRoKSArIDNdID0gMCksIChiLmRhdGFbNCAqIChjICsgKHRoaXMuaGVpZ2h0IC0gMikgKiB0aGlzLndpZHRoKSArIDNdID0gMCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYyA9IDI7IGMgPCB0aGlzLmhlaWdodCAtIDI7IGMrKykgKGIuZGF0YVs0ICogKDEgKyBjICogdGhpcy53aWR0aCkgKyAzXSA9IDApLCAoYi5kYXRhWzQgKiAodGhpcy53aWR0aCAtIDIgKyBjICogdGhpcy53aWR0aCkgKyAzXSA9IDApOwogICAgICAgICAgICAgICAgICAgICAgICBhLnB1dEltYWdlRGF0YShiLCAwLCAwKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGYoKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLlQpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoKHRoaXMuUyArPSBnKSwgMTUgPD0gdGhpcy5TKSkgdGhpcy5yZXNldCgpOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHJldHVybjsKICAgICAgICAgICAgICAgICAgICBpZiAoRyh0aGlzLCBsLnYpKSBsLmJhKCk7CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gbC51Yih0aGlzKTsKICAgICAgICAgICAgICAgICAgICAgICAgYSAmJiAhdGhpcy4kYSA/ICh0aGlzLiRhID0gITApIDogIWEgJiYgdGhpcy4kYSAmJiAodGhpcy5UID0gITEpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGMoKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGE7CiAgICAgICAgICAgICAgICAgICAgaWYgKDAuMiA+IHRoaXMuUykgYSA9IDEgLSB0aGlzLlMgLyAwLjI7CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoMTQuOCA8IHRoaXMuUykgYSA9IDEgLSAoMTUgLSB0aGlzLlMpIC8gMC4yOwogICAgICAgICAgICAgICAgICAgIGVsc2UgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIGxldCBiID0gMSAqIHRoaXMud2lkdGgsCiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSB0aGlzLmhlaWdodCAqIGEsCiAgICAgICAgICAgICAgICAgICAgICAgIGQgPSB0aGlzLnggKyAodGhpcy53aWR0aCAtIGIpIC8gMiwKICAgICAgICAgICAgICAgICAgICAgICAgZSA9IHRoaXMueSArICh0aGlzLmhlaWdodCAtIGMpIC8gMjsKICAgICAgICAgICAgICAgICAgICBTLmdsb2JhbEFscGhhID0gKGEgKyAxKSAvIDI7CiAgICAgICAgICAgICAgICAgICAgVyh0aGlzLkMsIGQsIGUsIGIsIGMpOwogICAgICAgICAgICAgICAgICAgIFYoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjbGFzcyBaYiBleHRlbmRzIEliIHsKICAgICAgICAgICAgICAgIGNvbnN0cnVjdG9yKGEpIHsKICAgICAgICAgICAgICAgICAgICBzdXBlcigpOwogICAgICAgICAgICAgICAgICAgIHRoaXMub2EgPSBhOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgVmIoKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHsgZ2E6IGEsIEQ6IGIgfSA9IFViW3RoaXMub2FdOwogICAgICAgICAgICAgICAgICAgIGRhKHRoaXMub2EpOwogICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGIgaW4gYSkgewogICAgICAgICAgICAgICAgICAgICAgICBsZXQgYyA9IHsgWzFdOiBLYiwgWzJdOiBMYiB9W2JdOwogICAgICAgICAgICAgICAgICAgICAgICBhW2JdLmZvckVhY2goKFthLCBiLCBkLCByXSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgSShhLCBiLCBhICsgZCAtIDEsIGIgKyByIC0gMSwgKGEsIGIpID0+IGsuS2EobmV3IGMoYSwgYikpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGIuZm9yRWFjaCgoYSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBsZXQgYiA9IGEuc2xpY2UoMSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoYVswXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGsucGMobmV3IEJiKC4uLmIpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrLmliKG5ldyBNYiguLi5iKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgay5pYihuZXcgWWIoLi4uYikpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGsuTChuZXcgUWIoLi4uYikpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGsuTChuZXcgVGIoLi4uYiksIDEyMCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgay5MKG5ldyBYYiguLi5iKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAwID09PSB0aGlzLm9hICYmIGsuTChuZXcgVmIoKSwgNTApOwogICAgICAgICAgICAgICAgICAgIHRoaXMub2EgPT09IFViLmxlbmd0aCAtIDEgJiYgay5MKG5ldyB2YighMCkpOwogICAgICAgICAgICAgICAgICAgIGsudmMoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjbGFzcyAkYiB7CiAgICAgICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHt9CiAgICAgICAgICAgICAgICBmKCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuemEgJiYgKCh0aGlzLlhhID0gITApLCB0aGlzLndiKHRoaXMuemEpLCAodGhpcy56YSA9IG51bGwpKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5YYTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGFjKCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuemEgfHwgKHRoaXMuemEgPSBuZXcgWmIodGhpcy5SYi5vYSArIDEpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGFzeW5jIHdiKGEpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLlJiID0gYTsKICAgICAgICAgICAgICAgICAgICB0aGlzLlhhID0gITA7CiAgICAgICAgICAgICAgICAgICAgYXdhaXQgYS5sb2FkKCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5YYSA9ICExOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGFjKCkgewogICAgICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFjKTsKICAgICAgICAgICAgICAgIGguZigpIHx8IChrLmYoKSwgY2ErKywgZmEoKSwgay5jKCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIChhc3luYyBmdW5jdGlvbiAoYSkgewogICAgICAgICAgICAgICAgYXdhaXQgZ2IoKTsKICAgICAgICAgICAgICAgIGggPSBuZXcgJGIoKTsKICAgICAgICAgICAgICAgIGF3YWl0IGEoKTsKICAgICAgICAgICAgICAgIGFjKCk7CiAgICAgICAgICAgIH0pKGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgIGNiLnBsYXkoKTsKICAgICAgICAgICAgICAgIGF3YWl0IGgud2IobmV3IFpiKDApKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgPC9zY3JpcHQ+CiAgICA8L2JvZHk+CjwvaHRtbD4=" style="border:none;width:100%;height:100%;" />
